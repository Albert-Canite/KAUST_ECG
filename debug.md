# debug 1.1

## 发现的问题
- **验证/泛化 Macro F1 偏低且 Acc 偏高**：日志显示 Val MacroF1 ≈0.35、Acc ≈0.92，且 Val 预测直方图以 N 为主（约95%），S/V/O 召回率很低。这说明模型大多输出多数类，Accuracy 主要由 N 类支撑，无法充分识别少数类。
- **训练分割可能缺少少数类样本**：当前按记录随机划分，没有强制检查训练集中每个类别是否存在。如果某些少数类全部落在验证/泛化记录，模型在训练阶段从未见过这些类别，必然导致极低召回。
- **缺乏可视化与可追踪产物**：之前只打印日志，没有将损失、F1 等随 epoch 的走势或混淆矩阵持久化，排查与复现困难。

## 本次修改
- 在 `main.py` 中对训练集类别计数增加强制检查，若任一类别为 0 直接报错，防止无样本类别导致的坍塌。
- 增加输出目录 `outputs/`，将 checkpoint、结果 JSON、训练日志、历史曲线（损失/准确率/宏 F1）及最佳轮次的验证/泛化混淆矩阵全部保存便于可视化与溯源。
- 提供绘图工具 `plot_confusion_matrix` 并在训练结束后自动生成曲线与热力图，便于确认少数类是否仍被模型忽视。

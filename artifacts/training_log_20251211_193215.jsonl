{"event": "start", "timestamp": "2025-12-11T19:32:25.100154", "config": {"data_path": "E:/OneDrive - KAUST/ONN codes/MIT-BIH/mit-bih-arrhythmia-database-1.0.0/", "batch_size": 128, "lr": 0.001, "weight_decay": 0.0001, "max_epochs": 90, "patience": 25, "min_epochs": 25, "scheduler_patience": 3, "dropout_rate": 0.2, "num_mlp_layers": 3, "constraint_scale": 1.0, "class_weight_abnormal": 1.35, "class_weight_max_ratio": 2.0, "generalization_score_weight": 0.35, "threshold_target_miss": 0.1, "threshold_max_fpr": 0.1, "threshold_recall_gain": 2.0, "threshold_miss_penalty": 1.25, "threshold_gen_recall_gain": 2.5, "threshold_gen_miss_penalty": 1.35, "seed": 42, "enable_kd": true, "kd_alpha": 0.1, "kd_temperature": 2.5, "kd_ema_decay": 0.995, "kd_start_epoch": 5, "kd_ramp_epochs": 5, "kd_guard_miss_margin": 0.02, "kd_guard_fpr_margin": 0.03, "use_value_constraint": true, "use_tanh_activations": false}, "class_counts": [39707, 2525], "class_weights": [2.9553844928741455, 11.289742469787598], "data_range": [-1.0, 1.0]}
{"event": "epoch", "epoch": 1, "train_loss": 0.60168638084874, "val_loss": 1.294425994005364, "val_f1": 0.25287356090554675, "val_miss": 0.05203252032435719, "val_fpr": 0.3432565624053673, "gen_f1": 0.5268983535229471, "gen_miss": 0.05081475128634045, "gen_fpr": 0.30708285225134085, "threshold": 0.7474007368087768, "kd_weight": 0.0, "kd_guard_allow": true, "teacher_val_miss": null, "teacher_val_fpr": null}
{"event": "best", "epoch": 1, "val_f1": 0.25287356090554675, "val_miss": 0.05203252032435719, "val_fpr": 0.3432565624053673, "gen_f1": 0.5268983535229471, "gen_miss": 0.05081475128634045, "gen_fpr": 0.30708285225134085, "threshold": 0.7474007368087768}
{"event": "epoch", "epoch": 2, "train_loss": 0.46147830377925525, "val_loss": 1.379726219276606, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02, "kd_weight": 0.0, "kd_guard_allow": true, "teacher_val_miss": null, "teacher_val_fpr": null}
{"event": "epoch", "epoch": 3, "train_loss": 0.4893426860823776, "val_loss": 1.5531909175613745, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02, "kd_weight": 0.0, "kd_guard_allow": true, "teacher_val_miss": null, "teacher_val_fpr": null}
{"event": "epoch", "epoch": 4, "train_loss": 0.49213873301491595, "val_loss": 1.5465396278214785, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02, "kd_weight": 0.0, "kd_guard_allow": true, "teacher_val_miss": null, "teacher_val_fpr": null}
{"event": "epoch", "epoch": 5, "train_loss": 0.45004786099448346, "val_loss": 1.4255288980476422, "val_f1": 0.3124468357920306, "val_miss": 0.10406504064871439, "val_fpr": 0.2374534848634844, "gen_f1": 0.6311534530179321, "gen_miss": 0.06260720411650385, "gen_fpr": 0.1918222717680488, "threshold": 0.7706027746200561, "kd_weight": 0.020000000000000004, "kd_guard_allow": false, "teacher_val_miss": 0.2699186991826029, "teacher_val_fpr": 0.0812632002412941}
{"event": "best", "epoch": 5, "val_f1": 0.3124468357920306, "val_miss": 0.10406504064871439, "val_fpr": 0.2374534848634844, "gen_f1": 0.6311534530179321, "gen_miss": 0.06260720411650385, "gen_fpr": 0.1918222717680488, "threshold": 0.7706027746200561}
{"event": "epoch", "epoch": 6, "train_loss": 0.4704631099195191, "val_loss": 1.4301597010707692, "val_f1": 0.38897058473282603, "val_miss": 0.13983739837170997, "val_fpr": 0.15850346977757365, "gen_f1": 0.6827891171210376, "gen_miss": 0.22212692967362324, "gen_fpr": 0.09296492415491779, "threshold": 0.7747074127197265, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.16585365853388856, "teacher_val_fpr": 0.1293372221662181}
{"event": "best", "epoch": 6, "val_f1": 0.38897058473282603, "val_miss": 0.13983739837170997, "val_fpr": 0.15850346977757365, "gen_f1": 0.6827891171210376, "gen_miss": 0.22212692967362324, "gen_fpr": 0.09296492415491779, "threshold": 0.7747074127197265}
{"event": "epoch", "epoch": 7, "train_loss": 0.467021891745654, "val_loss": 1.4197848043696495, "val_f1": 0.48953140152599545, "val_miss": 0.20162601625688412, "val_fpr": 0.09051594086282759, "gen_f1": 0.6524507277083782, "gen_miss": 0.30789022298390245, "gen_fpr": 0.07974678504595303, "threshold": 0.788, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.16097560975348008, "teacher_val_fpr": 0.12581715779933036}
{"event": "best", "epoch": 7, "val_f1": 0.48953140152599545, "val_miss": 0.20162601625688412, "val_fpr": 0.09051594086282759, "gen_f1": 0.6524507277083782, "gen_miss": 0.30789022298390245, "gen_fpr": 0.07974678504595303, "threshold": 0.788}
{"event": "epoch", "epoch": 8, "train_loss": 0.46238809291160465, "val_loss": 1.440576058916351, "val_f1": 0.35603112520937114, "val_miss": 0.10731707316898671, "val_fpr": 0.19310067384069887, "gen_f1": 0.6262214936592545, "gen_miss": 0.17560034305279673, "gen_fpr": 0.15013735716839186, "threshold": 0.7741408348083496, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.13008130081089297, "teacher_val_fpr": 0.14261289349276615}
{"event": "epoch", "epoch": 9, "train_loss": 0.4605932401888298, "val_loss": 1.4090146844552804, "val_f1": 0.4436026897621382, "val_miss": 0.14308943089198228, "val_fpr": 0.12410741224969916, "gen_f1": 0.6250111528645502, "gen_miss": 0.2493567752996369, "gen_fpr": 0.12095393558143051, "threshold": 0.788, "kd_weight": 0.0, "kd_guard_allow": true, "teacher_val_miss": 0.13658536585143763, "teacher_val_fpr": 0.1343658855474863}
{"event": "epoch", "epoch": 10, "train_loss": 0.4154275741541024, "val_loss": 1.3893875337094153, "val_f1": 0.4444444405848713, "val_miss": 0.14796747967239077, "val_fpr": 0.12259881323531871, "gen_f1": 0.620060246788593, "gen_miss": 0.24978559176618828, "gen_fpr": 0.12433809770270161, "threshold": 0.788, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.13333333333116532, "teacher_val_fpr": 0.13858996278775157}
{"event": "epoch", "epoch": 11, "train_loss": 0.41494356592496234, "val_loss": 1.3773853018284297, "val_f1": 0.47290639994542644, "val_miss": 0.1414634146318461, "val_fpr": 0.10962486171164676, "gen_f1": 0.6231779688548292, "gen_miss": 0.2575042881641134, "gen_fpr": 0.11892343830866786, "threshold": 0.7844513893127442, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.13658536585143763, "teacher_val_fpr": 0.12209594689719189}
{"event": "epoch", "epoch": 12, "train_loss": 0.41379109250776697, "val_loss": 1.3714081694804756, "val_f1": 0.4786557634540023, "val_miss": 0.14308943089198228, "val_fpr": 0.10660766368288584, "gen_f1": 0.6205473257733282, "gen_miss": 0.2585763293304919, "gen_fpr": 0.12035673050120621, "threshold": 0.7832697868347167, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.13495934959130146, "teacher_val_fpr": 0.12300110630582016}
{"event": "epoch", "epoch": 13, "train_loss": 0.4123916823755611, "val_loss": 1.3783775735113697, "val_f1": 0.4206411222239173, "val_miss": 0.1252032520304845, "val_fpr": 0.1413054410136364, "gen_f1": 0.6267665540393563, "gen_miss": 0.21076329331001123, "gen_fpr": 0.13540629852285885, "threshold": 0.788, "kd_weight": 0.1, "kd_guard_allow": false, "teacher_val_miss": 0.15284552845279925, "teacher_val_fpr": 0.11465352509291495}
{"event": "epoch", "epoch": 14, "train_loss": 0.45683628998019477, "val_loss": 1.3753389665903886, "val_f1": 0.47700630798059734, "val_miss": 0.13983739837170997, "val_fpr": 0.10801568942964093, "gen_f1": 0.6114751146829225, "gen_miss": 0.2596483704968704, "gen_fpr": 0.12648803599150915, "threshold": 0.788, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.1642276422737524, "teacher_val_fpr": 0.10741224982388875}
{"event": "epoch", "epoch": 15, "train_loss": 0.46262836781415073, "val_loss": 1.375722752486379, "val_f1": 0.46457398703267316, "val_miss": 0.15772357723320773, "val_fpr": 0.1103288745850243, "gen_f1": 0.6130247529362566, "gen_miss": 0.26736706689479556, "gen_fpr": 0.12210853206986419, "threshold": 0.788, "kd_weight": 0.0, "kd_guard_allow": true, "teacher_val_miss": 0.1772357723548417, "teacher_val_fpr": 0.09986925475198645}
{"event": "epoch", "epoch": 16, "train_loss": 0.4111787348082571, "val_loss": 1.3656095072138736, "val_f1": 0.3886925761007754, "val_miss": 0.10569105690885056, "val_fpr": 0.16745449059623105, "gen_f1": 0.6066698533124373, "gen_miss": 0.18481989708365176, "gen_fpr": 0.16196201775683322, "threshold": 0.7492237985134125, "kd_weight": 0.1, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 17, "train_loss": 0.4567831185731021, "val_loss": 1.361043782188125, "val_f1": 0.4551254746526859, "val_miss": 0.13008130081089297, "val_fpr": 0.12078849441806215, "gen_f1": 0.6252065708052963, "gen_miss": 0.22941680960499697, "gen_fpr": 0.1289564836564363, "threshold": 0.7851532697677612, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.1593495934933439, "teacher_val_fpr": 0.10711053002101266}
{"event": "epoch", "epoch": 18, "train_loss": 0.45693577934395185, "val_loss": 1.3571848114414362, "val_f1": 0.46450481639157115, "val_miss": 0.1382113821115738, "val_fpr": 0.11435180529003885, "gen_f1": 0.6145787817274071, "gen_miss": 0.24528301886739862, "gen_fpr": 0.13023052116091482, "threshold": 0.7848799228668213, "kd_weight": 0.0, "kd_guard_allow": true, "teacher_val_miss": 0.15772357723320773, "teacher_val_fpr": 0.10821683596489165}
{"event": "epoch", "epoch": 19, "train_loss": 0.412335971810601, "val_loss": 1.3417093009744592, "val_f1": 0.47465230645319945, "val_miss": 0.13983739837170997, "val_fpr": 0.10912199537351994, "gen_f1": 0.6142769290462332, "gen_miss": 0.24999999999946398, "gen_fpr": 0.12847871959225685, "threshold": 0.7813141345977783, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.13333333333116532, "teacher_val_fpr": 0.11606155083967006}
{"event": "epoch", "epoch": 20, "train_loss": 0.4126655568679174, "val_loss": 1.3436357221451645, "val_f1": 0.46756756355769424, "val_miss": 0.1560975609730716, "val_fpr": 0.1092225686411453, "gen_f1": 0.6185493198835611, "gen_miss": 0.2585763293304919, "gen_fpr": 0.12179002269374456, "threshold": 0.788, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.1723577235744332, "teacher_val_fpr": 0.10127728049874155}
{"event": "epoch", "epoch": 21, "train_loss": 0.4110980999289137, "val_loss": 1.339172406977021, "val_f1": 0.4719306212428546, "val_miss": 0.1593495934933439, "val_fpr": 0.10650709041526046, "gen_f1": 0.6195769044196191, "gen_miss": 0.2590051457970433, "gen_fpr": 0.12087430823740061, "threshold": 0.7821367144584656, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.16097560975348008, "teacher_val_fpr": 0.10620537061238437}
{"event": "epoch", "epoch": 22, "train_loss": 0.41014496196400035, "val_loss": 1.33431622710592, "val_f1": 0.4844036656698469, "val_miss": 0.1414634146318461, "val_fpr": 0.10429447852750245, "gen_f1": 0.617474688806452, "gen_miss": 0.2545025728982536, "gen_fpr": 0.12425847035867171, "threshold": 0.7805413007736206, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.1382113821115738, "teacher_val_fpr": 0.1114351805289033}
{"event": "epoch", "epoch": 23, "train_loss": 0.41124802349191725, "val_loss": 1.3390074572704984, "val_f1": 0.4698412658146103, "val_miss": 0.15772357723320773, "val_fpr": 0.1078145428943902, "gen_f1": 0.6149703774685303, "gen_miss": 0.26543739279531425, "gen_fpr": 0.12151132698963987, "threshold": 0.7809908151626587, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.17398373983456936, "teacher_val_fpr": 0.09745549632897771}
{"event": "epoch", "epoch": 24, "train_loss": 0.410003550305511, "val_loss": 1.3349782614618524, "val_f1": 0.4611398924684668, "val_miss": 0.13170731707102915, "val_fpr": 0.11736900331879978, "gen_f1": 0.6209530374507203, "gen_miss": 0.23306174957068385, "gen_fpr": 0.1305888442090494, "threshold": 0.7797145843505859, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.13333333333116532, "teacher_val_fpr": 0.11716785678354905}
{"event": "epoch", "epoch": 25, "train_loss": 0.41174364830508375, "val_loss": 1.3338114826668843, "val_f1": 0.46220301985242274, "val_miss": 0.13008130081089297, "val_fpr": 0.11716785678354905, "gen_f1": 0.6223842966469424, "gen_miss": 0.23156089193775395, "gen_fpr": 0.1301508938168849, "threshold": 0.7795788049697876, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.13170731707102915, "teacher_val_fpr": 0.11767072312167587}
{"event": "epoch", "epoch": 26, "train_loss": 0.4112632890542348, "val_loss": 1.3344811256420976, "val_f1": 0.47021372948184104, "val_miss": 0.1593495934933439, "val_fpr": 0.10731167655626338, "gen_f1": 0.6148187967109214, "gen_miss": 0.2652229845620386, "gen_fpr": 0.12171039534971465, "threshold": 0.7829833388328552, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.1642276422737524, "teacher_val_fpr": 0.10399275872462636}
{"event": "epoch", "epoch": 27, "train_loss": 0.41179760938340965, "val_loss": 1.332237751042669, "val_f1": 0.4637429400674572, "val_miss": 0.13170731707102915, "val_fpr": 0.11606155083967006, "gen_f1": 0.6211147720506669, "gen_miss": 0.23306174957068385, "gen_fpr": 0.13046940319300454, "threshold": 0.7792674899101257, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.13008130081089297, "teacher_val_fpr": 0.1189781756008056}
{"event": "epoch", "epoch": 28, "train_loss": 0.41085846722126007, "val_loss": 1.3316199983649915, "val_f1": 0.46001719301072636, "val_miss": 0.13008130081089297, "val_fpr": 0.11827416272742805, "gen_f1": 0.6209942789180652, "gen_miss": 0.23134648370447825, "gen_fpr": 0.13126567663330363, "threshold": 0.7789661884307861, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.13008130081089297, "teacher_val_fpr": 0.11907874886843096}
{"event": "epoch", "epoch": 29, "train_loss": 0.4130484023780534, "val_loss": 1.332459102414914, "val_f1": 0.4704813765330957, "val_miss": 0.15772357723320773, "val_fpr": 0.10751282309151411, "gen_f1": 0.6130103136602866, "gen_miss": 0.26758147512807123, "gen_fpr": 0.12202890472583428, "threshold": 0.7805837512016296, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.16097560975348008, "teacher_val_fpr": 0.10499849140088001}
{"event": "epoch", "epoch": 30, "train_loss": 0.4110040874192209, "val_loss": 1.3325289536841238, "val_f1": 0.47005444243319766, "val_miss": 0.15772357723320773, "val_fpr": 0.10771396962676484, "gen_f1": 0.6141972490129118, "gen_miss": 0.26629502572841707, "gen_fpr": 0.12171039534971465, "threshold": 0.7802543282508849, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.1593495934933439, "teacher_val_fpr": 0.10660766368288584}
{"event": "epoch", "epoch": 31, "train_loss": 0.40892545237685696, "val_loss": 1.3318619122670488, "val_f1": 0.4577284333564378, "val_miss": 0.12845528455075683, "val_fpr": 0.11978276174180852, "gen_f1": 0.621418054226618, "gen_miss": 0.23048885077137546, "gen_fpr": 0.13130549030531857, "threshold": 0.7790241241455078, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.12845528455075683, "teacher_val_fpr": 0.11958161520655779}
{"event": "epoch", "epoch": 32, "train_loss": 0.410807904420477, "val_loss": 1.3323352941849802, "val_f1": 0.4704813765330957, "val_miss": 0.15772357723320773, "val_fpr": 0.10751282309151411, "gen_f1": 0.6146253876845097, "gen_miss": 0.26565180102858993, "gen_fpr": 0.12167058167769969, "threshold": 0.7793966770172119, "kd_weight": 0.1, "kd_guard_allow": true, "teacher_val_miss": 0.15772357723320773, "teacher_val_fpr": 0.10721110328863802}
{"event": "final", "best_threshold": 0.7793966770172119, "val_loss": 1.3323352941849802, "val_f1": 0.4704813765330957, "val_miss": 0.15772357723320773, "val_fpr": 0.10751282309151411, "gen_loss": 1.221882781617841, "gen_f1": 0.6146253876845097, "gen_miss": 0.26565180102858993, "gen_fpr": 0.12167058167769969}

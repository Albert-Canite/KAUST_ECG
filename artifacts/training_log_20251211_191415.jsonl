{"event": "start", "timestamp": "2025-12-11T19:14:24.988065", "config": {"data_path": "E:/OneDrive - KAUST/ONN codes/MIT-BIH/mit-bih-arrhythmia-database-1.0.0/", "batch_size": 128, "lr": 0.001, "weight_decay": 0.0001, "max_epochs": 90, "patience": 25, "min_epochs": 25, "scheduler_patience": 3, "dropout_rate": 0.2, "num_mlp_layers": 3, "constraint_scale": 1.0, "class_weight_abnormal": 1.35, "class_weight_max_ratio": 2.0, "generalization_score_weight": 0.35, "threshold_target_miss": 0.1, "threshold_max_fpr": 0.1, "threshold_recall_gain": 2.0, "threshold_miss_penalty": 1.25, "threshold_gen_recall_gain": 2.5, "threshold_gen_miss_penalty": 1.35, "seed": 42, "enable_kd": true, "kd_alpha": 0.1, "kd_temperature": 2.5, "kd_ema_decay": 0.995, "kd_start_epoch": 5, "kd_ramp_epochs": 5, "kd_guard_miss_margin": 0.02, "kd_guard_fpr_margin": 0.03, "use_value_constraint": true, "use_tanh_activations": false}, "class_counts": [39707, 2525], "class_weights": [2.9553844928741455, 11.289742469787598], "data_range": [-1.0, 1.0]}
{"event": "epoch", "epoch": 1, "train_loss": 0.60168638084874, "val_loss": 1.294425994005364, "val_f1": 0.25287356090554675, "val_miss": 0.05203252032435719, "val_fpr": 0.3432565624053673, "gen_f1": 0.5268983535229471, "gen_miss": 0.05081475128634045, "gen_fpr": 0.30708285225134085, "threshold": 0.7474007368087768, "kd_weight": 0.0, "kd_guard_allow": true, "teacher_val_miss": null, "teacher_val_fpr": null}
{"event": "best", "epoch": 1, "val_f1": 0.25287356090554675, "val_miss": 0.05203252032435719, "val_fpr": 0.3432565624053673, "gen_f1": 0.5268983535229471, "gen_miss": 0.05081475128634045, "gen_fpr": 0.30708285225134085, "threshold": 0.7474007368087768}
{"event": "epoch", "epoch": 2, "train_loss": 0.46147830377925525, "val_loss": 1.379726219276606, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02, "kd_weight": 0.0, "kd_guard_allow": true, "teacher_val_miss": null, "teacher_val_fpr": null}
{"event": "epoch", "epoch": 3, "train_loss": 0.4893426860823776, "val_loss": 1.5531909175613745, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02, "kd_weight": 0.0, "kd_guard_allow": true, "teacher_val_miss": null, "teacher_val_fpr": null}
{"event": "epoch", "epoch": 4, "train_loss": 0.49213873301491595, "val_loss": 1.5465396278214785, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02, "kd_weight": 0.0, "kd_guard_allow": true, "teacher_val_miss": null, "teacher_val_fpr": null}
{"event": "epoch", "epoch": 5, "train_loss": 0.45004786099448346, "val_loss": 1.4255288980476422, "val_f1": 0.3124468357920306, "val_miss": 0.10406504064871439, "val_fpr": 0.2374534848634844, "gen_f1": 0.6311534530179321, "gen_miss": 0.06260720411650385, "gen_fpr": 0.1918222717680488, "threshold": 0.7706027746200561, "kd_weight": 0.020000000000000004, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "best", "epoch": 5, "val_f1": 0.3124468357920306, "val_miss": 0.10406504064871439, "val_fpr": 0.2374534848634844, "gen_f1": 0.6311534530179321, "gen_miss": 0.06260720411650385, "gen_fpr": 0.1918222717680488, "threshold": 0.7706027746200561}
{"event": "epoch", "epoch": 6, "train_loss": 0.4704631099195191, "val_loss": 1.4301597010707692, "val_f1": 0.38897058473282603, "val_miss": 0.13983739837170997, "val_fpr": 0.15850346977757365, "gen_f1": 0.6827891171210376, "gen_miss": 0.22212692967362324, "gen_fpr": 0.09296492415491779, "threshold": 0.7747074127197265, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "best", "epoch": 6, "val_f1": 0.38897058473282603, "val_miss": 0.13983739837170997, "val_fpr": 0.15850346977757365, "gen_f1": 0.6827891171210376, "gen_miss": 0.22212692967362324, "gen_fpr": 0.09296492415491779, "threshold": 0.7747074127197265}
{"event": "epoch", "epoch": 7, "train_loss": 0.467021891745654, "val_loss": 1.4197848043696495, "val_f1": 0.48953140152599545, "val_miss": 0.20162601625688412, "val_fpr": 0.09051594086282759, "gen_f1": 0.6524507277083782, "gen_miss": 0.30789022298390245, "gen_fpr": 0.07974678504595303, "threshold": 0.788, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "best", "epoch": 7, "val_f1": 0.48953140152599545, "val_miss": 0.20162601625688412, "val_fpr": 0.09051594086282759, "gen_f1": 0.6524507277083782, "gen_miss": 0.30789022298390245, "gen_fpr": 0.07974678504595303, "threshold": 0.788}
{"event": "epoch", "epoch": 8, "train_loss": 0.46238809291160465, "val_loss": 1.440576058916351, "val_f1": 0.35603112520937114, "val_miss": 0.10731707316898671, "val_fpr": 0.19310067384069887, "gen_f1": 0.6262214936592545, "gen_miss": 0.17560034305279673, "gen_fpr": 0.15013735716839186, "threshold": 0.7741408348083496, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 9, "train_loss": 0.4605932401888298, "val_loss": 1.4090146844552804, "val_f1": 0.4436026897621382, "val_miss": 0.14308943089198228, "val_fpr": 0.12410741224969916, "gen_f1": 0.6250111528645502, "gen_miss": 0.2493567752996369, "gen_fpr": 0.12095393558143051, "threshold": 0.788, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 10, "train_loss": 0.45939157957380466, "val_loss": 1.4096775191099857, "val_f1": 0.3797292573127582, "val_miss": 0.11056910568925904, "val_fpr": 0.1728854470480007, "gen_f1": 0.6081871298213466, "gen_miss": 0.18610634648330596, "gen_fpr": 0.1601704025161603, "threshold": 0.7609138786792755, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 11, "train_loss": 0.45971235994136694, "val_loss": 1.3823872240774333, "val_f1": 0.4711150878093027, "val_miss": 0.14471544715211845, "val_fpr": 0.10982600824689748, "gen_f1": 0.6210185303088551, "gen_miss": 0.2600771869634218, "gen_fpr": 0.1194012023728473, "threshold": 0.7879442214965819, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 12, "train_loss": 0.45813575703086273, "val_loss": 1.383089467485106, "val_f1": 0.44932432047528786, "val_miss": 0.13495934959130146, "val_fpr": 0.12279995977056944, "gen_f1": 0.6177955723998676, "gen_miss": 0.23927958833567908, "gen_fpr": 0.13034996217695968, "threshold": 0.788, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 13, "train_loss": 0.4558791514598962, "val_loss": 1.3736755314548939, "val_f1": 0.4496387551661027, "val_miss": 0.13983739837170997, "val_fpr": 0.12159308055906506, "gen_f1": 0.6317561532213207, "gen_miss": 0.2356346483699922, "gen_fpr": 0.12171039534971465, "threshold": 0.788, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 14, "train_loss": 0.4568403619708437, "val_loss": 1.3658179143857585, "val_f1": 0.4804722938808704, "val_miss": 0.13983739837170997, "val_fpr": 0.1064065171476351, "gen_f1": 0.6261103585234302, "gen_miss": 0.2519296740989453, "gen_fpr": 0.11912250666874263, "threshold": 0.7831488847732543, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 15, "train_loss": 0.455949191884561, "val_loss": 1.3610463528092058, "val_f1": 0.46133908896690107, "val_miss": 0.13170731707102915, "val_fpr": 0.11726843005117442, "gen_f1": 0.6303810819588767, "gen_miss": 0.23391938250378663, "gen_fpr": 0.12338256957434272, "threshold": 0.785504162311554, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 16, "train_loss": 0.45480172769589855, "val_loss": 1.3590521595202107, "val_f1": 0.4657293457883478, "val_miss": 0.1382113821115738, "val_fpr": 0.11374836568428667, "gen_f1": 0.621974911246551, "gen_miss": 0.24506861063412294, "gen_fpr": 0.12489548911091097, "threshold": 0.7857699990272522, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 17, "train_loss": 0.45697107179598373, "val_loss": 1.3461067560925406, "val_f1": 0.4733096045620663, "val_miss": 0.13495934959130146, "val_fpr": 0.11073116765552575, "gen_f1": 0.6296955621714706, "gen_miss": 0.24163807890171177, "gen_fpr": 0.12075486722135576, "threshold": 0.7833964824676514, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 18, "train_loss": 0.4584719541397962, "val_loss": 1.3483254592918632, "val_f1": 0.4753363188711416, "val_miss": 0.1382113821115738, "val_fpr": 0.10912199537351994, "gen_f1": 0.6236119699169669, "gen_miss": 0.2474271012001556, "gen_fpr": 0.12274555082210345, "threshold": 0.7842105031013489, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 19, "train_loss": 0.45467161373658616, "val_loss": 1.3438759689462931, "val_f1": 0.47619047218720767, "val_miss": 0.1382113821115738, "val_fpr": 0.10871970230301847, "gen_f1": 0.6235815554323133, "gen_miss": 0.24592624356722573, "gen_fpr": 0.12338256957434272, "threshold": 0.7832342982292175, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 20, "train_loss": 0.47314059093143, "val_loss": 1.3512762952288977, "val_f1": 0.4663755419187545, "val_miss": 0.13170731707102915, "val_fpr": 0.11475409836054032, "gen_f1": 0.6315696600592826, "gen_miss": 0.23220411663758103, "gen_fpr": 0.12322331488628291, "threshold": 0.784740149974823, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 21, "train_loss": 0.45477203952543666, "val_loss": 1.3487038877475983, "val_f1": 0.46147185756079917, "val_miss": 0.13333333333116532, "val_fpr": 0.11686613698067295, "gen_f1": 0.6277641229276778, "gen_miss": 0.23306174957068385, "gen_fpr": 0.12561213520718015, "threshold": 0.7839495539665222, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 22, "train_loss": 0.45390527952801096, "val_loss": 1.343284845103773, "val_f1": 0.48101265420892214, "val_miss": 0.13495934959130146, "val_fpr": 0.10711053002101266, "gen_f1": 0.6272727224137852, "gen_miss": 0.24549742710067432, "gen_fpr": 0.12091412190941557, "threshold": 0.783673882484436, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 23, "train_loss": 0.45413712326324346, "val_loss": 1.344468233733946, "val_f1": 0.46193771235406744, "val_miss": 0.13170731707102915, "val_fpr": 0.11696671024829833, "gen_f1": 0.6293337966201911, "gen_miss": 0.23134648370447825, "gen_fpr": 0.12517418481501566, "threshold": 0.7831687927246094, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 24, "train_loss": 0.4542727966200222, "val_loss": 1.338598631891163, "val_f1": 0.47209919886653967, "val_miss": 0.13333333333116532, "val_fpr": 0.11163632706415404, "gen_f1": 0.6293470497962875, "gen_miss": 0.2394939965689548, "gen_fpr": 0.12186965003777446, "threshold": 0.7823818325996399, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 25, "train_loss": 0.4573233200745149, "val_loss": 1.3388353017361514, "val_f1": 0.4663167064740722, "val_miss": 0.13333333333116532, "val_fpr": 0.11445237855766423, "gen_f1": 0.6287925375928, "gen_miss": 0.23349056603723523, "gen_fpr": 0.1246964207508362, "threshold": 0.7820578813552856, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 26, "train_loss": 0.4538495751944455, "val_loss": 1.336559619612711, "val_f1": 0.4725177265264221, "val_miss": 0.13333333333116532, "val_fpr": 0.1114351805289033, "gen_f1": 0.6292730275714777, "gen_miss": 0.23627787306981932, "gen_fpr": 0.12322331488628291, "threshold": 0.781789243221283, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 27, "train_loss": 0.4562639900229194, "val_loss": 1.3354524295423535, "val_f1": 0.47230836997878906, "val_miss": 0.13333333333116532, "val_fpr": 0.11153575379652866, "gen_f1": 0.6292730275714777, "gen_miss": 0.23627787306981932, "gen_fpr": 0.12322331488628291, "threshold": 0.7814810276031494, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 28, "train_loss": 0.4535996947324637, "val_loss": 1.335005657807018, "val_f1": 0.4652989921399072, "val_miss": 0.13333333333116532, "val_fpr": 0.11495524489579105, "gen_f1": 0.6284609251074587, "gen_miss": 0.23349056603723523, "gen_fpr": 0.12493530278292593, "threshold": 0.7810549139976501, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 29, "train_loss": 0.4551995401129578, "val_loss": 1.3325679925473086, "val_f1": 0.47189021294341216, "val_miss": 0.13333333333116532, "val_fpr": 0.1117369003317794, "gen_f1": 0.6288841759457062, "gen_miss": 0.23627787306981932, "gen_fpr": 0.12350201059038758, "threshold": 0.7808268070220947, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 30, "train_loss": 0.4537158995866776, "val_loss": 1.3328397946051518, "val_f1": 0.4663755419187545, "val_miss": 0.13170731707102915, "val_fpr": 0.11475409836054032, "gen_f1": 0.6292648562226834, "gen_miss": 0.23284734133740814, "gen_fpr": 0.1246167934068063, "threshold": 0.7806624174118042, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 31, "train_loss": 0.4519695508660692, "val_loss": 1.3319284778852585, "val_f1": 0.41273407884827407, "val_miss": 0.10406504064871439, "val_fpr": 0.15126219450854744, "gen_f1": 0.6211200478266123, "gen_miss": 0.18910806174916572, "gen_fpr": 0.14858462395980865, "threshold": 0.74, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "epoch", "epoch": 32, "train_loss": 0.453831386385542, "val_loss": 1.331193382935579, "val_f1": 0.4118307714428488, "val_miss": 0.10569105690885056, "val_fpr": 0.15146334104379816, "gen_f1": 0.620933866633901, "gen_miss": 0.1916809605484741, "gen_fpr": 0.1476689095034647, "threshold": 0.74, "kd_weight": 0.0, "kd_guard_allow": false, "teacher_val_miss": 0.0, "teacher_val_fpr": 0.9999999999989941}
{"event": "final", "best_threshold": 0.74, "val_loss": 1.331193382935579, "val_f1": 0.4118307714428488, "val_miss": 0.10569105690885056, "val_fpr": 0.15146334104379816, "gen_loss": 1.218271270319772, "gen_f1": 0.620933866633901, "gen_miss": 0.1916809605484741, "gen_fpr": 0.1476689095034647}

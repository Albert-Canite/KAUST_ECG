{"event": "start", "timestamp": "2025-12-17T16:10:30.720068", "config": {"data_path": "E:/OneDrive - KAUST/ONN codes/MIT-BIH/mit-bih-arrhythmia-database-1.0.0/", "batch_size": 128, "lr": 0.001, "weight_decay": 0.0001, "max_epochs": 90, "patience": 25, "min_epochs": 25, "scheduler_patience": 3, "dropout_rate": 0.2, "num_mlp_layers": 3, "constraint_scale": 1.0, "class_weight_abnormal": 1.35, "class_weight_max_ratio": 2.0, "generalization_score_weight": 0.35, "threshold_target_miss": 0.1, "threshold_max_fpr": 0.1, "threshold_recall_gain": 2.0, "threshold_miss_penalty": 1.25, "threshold_gen_recall_gain": 2.5, "threshold_gen_miss_penalty": 1.35, "use_fn_penalty_4cls": false, "use_fn_penalty": true, "seed": 42, "use_value_constraint": true, "use_tanh_activations": false}, "class_counts": [47677, 1973, 2238, 7200], "class_weights": [0.5, 1.530752420425415, 1.4372702836990356, 0.8013131022453308], "data_range": [-1.0, 1.0]}
{"event": "epoch", "epoch": 1, "train_loss": 1.3171439503642108, "val_loss": 1.9595961732127805, "val_f1": 0.37272479985422735, "val_miss": 0.06348122866872533, "val_fpr": 0.7641644853493504, "val_macro_f1": 0.07049560785268458, "gen_f1": 0.36696380028851455, "gen_miss": 0.027210884353692785, "gen_fpr": 0.6034135894605089, "gen_macro_f1": 0.12323439942141833, "threshold": 0.8735240578651429}
{"event": "best", "epoch": 1, "val_f1": 0.37272479985422735, "val_miss": 0.06348122866872533, "val_fpr": 0.7641644853493504, "val_macro_f1": 0.07049560785268458, "gen_f1": 0.36696380028851455, "gen_miss": 0.027210884353692785, "gen_fpr": 0.6034135894605089, "gen_macro_f1": 0.12323439942141833, "threshold": 0.8735240578651429}
{"event": "epoch", "epoch": 2, "train_loss": 1.2213622612453494, "val_loss": 2.0961442893451805, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07951956536900878, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.1175141143866847, "threshold": 0.02}
{"event": "epoch", "epoch": 3, "train_loss": 1.1241397773415747, "val_loss": 2.010004737789836, "val_f1": 0.37042914453124565, "val_miss": 0.04402730375411595, "val_fpr": 0.7930423034697348, "val_macro_f1": 0.08304854961988592, "gen_f1": 0.33849445833059016, "gen_miss": 0.03723594701031644, "gen_fpr": 0.6753196184046092, "gen_macro_f1": 0.11767662668087597, "threshold": 0.8788566589355469}
{"event": "epoch", "epoch": 4, "train_loss": 1.0927291828185732, "val_loss": 2.001525713370518, "val_f1": 0.3460824775046441, "val_miss": 0.01331058020473273, "val_fpr": 0.9191927721008872, "val_macro_f1": 0.0762607158644228, "gen_f1": 0.27466791757269693, "gen_miss": 0.006086645184378649, "gen_fpr": 0.950386137971007, "gen_macro_f1": 0.11689154624141747, "threshold": 0.8686333060264587}
{"event": "epoch", "epoch": 5, "train_loss": 1.0593622602681754, "val_loss": 1.965642854790225, "val_f1": 0.3426698421707656, "val_miss": 0.018771331057956413, "val_fpr": 0.9267077598573615, "val_macro_f1": 0.07558016134536773, "gen_f1": 0.2750161050636699, "gen_miss": 0.006623702112412059, "gen_fpr": 0.9481147381397403, "gen_macro_f1": 0.12263285505212977, "threshold": 0.8605707883834839}
{"event": "epoch", "epoch": 6, "train_loss": 1.036603263875123, "val_loss": 1.948445097785066, "val_f1": 0.34288131204791505, "val_miss": 0.03174061433436266, "val_fpr": 0.9103267753095412, "val_macro_f1": 0.07400395282971778, "gen_f1": 0.27290198353252293, "gen_miss": 0.008592910848534564, "gen_fpr": 0.9559997404111377, "gen_macro_f1": 0.12854639486487915, "threshold": 0.8589590072631836}
{"event": "epoch", "epoch": 7, "train_loss": 1.0123786335226452, "val_loss": 1.9379062892733323, "val_f1": 0.3427955414825544, "val_miss": 0.023208191126200657, "val_fpr": 0.920881533394477, "val_macro_f1": 0.07408499706541714, "gen_f1": 0.2731724182339502, "gen_miss": 0.011278195488701615, "gen_fpr": 0.9516191835936947, "gen_macro_f1": 0.1322942492424562, "threshold": 0.8532474517822266}
{"event": "epoch", "epoch": 8, "train_loss": 1.0039672235986776, "val_loss": 1.9145797654882488, "val_f1": 0.3428021155348121, "val_miss": 0.027986348122771378, "val_fpr": 0.9151397449962719, "val_macro_f1": 0.07376681074856706, "gen_f1": 0.27207660555004687, "gen_miss": 0.013247404224824118, "gen_fpr": 0.9546369005123776, "gen_macro_f1": 0.12628579034134876, "threshold": 0.8488469123840332}
{"event": "epoch", "epoch": 9, "train_loss": 1.0053411685707057, "val_loss": 1.9088502404152852, "val_f1": 0.34335433253501607, "val_miss": 0.023549488054527137, "val_fpr": 0.9181795153247334, "val_macro_f1": 0.07146745345269293, "gen_f1": 0.27339444769318305, "gen_miss": 0.009667024704601384, "gen_fpr": 0.952397949250129, "gen_macro_f1": 0.12080832513908464, "threshold": 0.8477640986442566}
{"event": "epoch", "epoch": 10, "train_loss": 0.998359448293861, "val_loss": 1.9404042902566048, "val_f1": 0.3415214388631051, "val_miss": 0.020136518771262334, "val_fpr": 0.9298319682505025, "val_macro_f1": 0.06892444119908377, "gen_f1": 0.27419954623526227, "gen_miss": 0.010383100608645932, "gen_fpr": 0.9477253553115232, "gen_macro_f1": 0.12269573519239525, "threshold": 0.8481835007667542}
{"event": "epoch", "epoch": 11, "train_loss": 0.9948625575550326, "val_loss": 1.92829511937538, "val_f1": 0.3420645286114118, "val_miss": 0.019453924914609372, "val_fpr": 0.9283965211509512, "val_macro_f1": 0.06790236947459477, "gen_f1": 0.27380007694729924, "gen_miss": 0.011457214464712751, "gen_fpr": 0.9484067752609032, "gen_macro_f1": 0.12230001074752277, "threshold": 0.8453394770622253}
{"event": "epoch", "epoch": 12, "train_loss": 0.9936020163188225, "val_loss": 1.9048575438296296, "val_f1": 0.34303124151087294, "val_miss": 0.020136518771262334, "val_fpr": 0.9235835514642206, "val_macro_f1": 0.06980384789618141, "gen_f1": 0.2733011487491936, "gen_miss": 0.011815252416735025, "gen_fpr": 0.950386137971007, "gen_macro_f1": 0.12492804401750239, "threshold": 0.8400359988212586}
{"event": "epoch", "epoch": 13, "train_loss": 0.9943089436425964, "val_loss": 1.944489849047066, "val_f1": 0.34247475363874885, "val_miss": 0.021843003412894735, "val_fpr": 0.923836865658259, "val_macro_f1": 0.07079544349348375, "gen_f1": 0.27447582502965284, "gen_miss": 0.007518796992467743, "gen_fpr": 0.949672269452609, "gen_macro_f1": 0.133139401074332, "threshold": 0.8408892273902893}
{"event": "epoch", "epoch": 14, "train_loss": 0.9879332388315684, "val_loss": 1.9262092515673914, "val_f1": 0.34058611660578386, "val_miss": 0.01433447098971217, "val_fpr": 0.9407244785941562, "val_macro_f1": 0.07344351655025812, "gen_f1": 0.2690081119871797, "gen_miss": 0.0059076262083675125, "gen_fpr": 0.9781945616195151, "gen_macro_f1": 0.1325133562362407, "threshold": 0.8360000000000001}
{"event": "epoch", "epoch": 15, "train_loss": 0.9790980110089694, "val_loss": 1.89428668621551, "val_f1": 0.3458718874961082, "val_miss": 0.01774744027297697, "val_fpr": 0.9148019927375539, "val_macro_f1": 0.06977880003068027, "gen_f1": 0.2763482352427406, "gen_miss": 0.006981740064434333, "gen_fpr": 0.9413978843529945, "gen_macro_f1": 0.12497348889255867, "threshold": 0.8360000000000001}
{"event": "epoch", "epoch": 16, "train_loss": 0.9867068328510091, "val_loss": 1.9030555323838525, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07509207800049264, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.13054022393598577, "threshold": 0.02}
{"event": "epoch", "epoch": 17, "train_loss": 0.9792528222190181, "val_loss": 1.9089453348993715, "val_f1": 0.3429259453178909, "val_miss": 0.027986348122771378, "val_fpr": 0.9146331166081949, "val_macro_f1": 0.07288717400984233, "gen_f1": 0.27410916749764286, "gen_miss": 0.005728607232356376, "gen_fpr": 0.9534687520277262, "gen_macro_f1": 0.13152162925212624, "threshold": 0.8326281905174255}
{"event": "epoch", "epoch": 18, "train_loss": 0.982852056489351, "val_loss": 1.8662674610449999, "val_f1": 0.34343193569505637, "val_miss": 0.01535836177469161, "val_fpr": 0.9276365785688359, "val_macro_f1": 0.06839167797986123, "gen_f1": 0.2757543426907835, "gen_miss": 0.004475474400278418, "gen_fpr": 0.9470439353621432, "gen_macro_f1": 0.13293224972255135, "threshold": 0.8286913514137269}
{"event": "epoch", "epoch": 19, "train_loss": 0.9771827854601439, "val_loss": 1.861305434952526, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.06966232106211834, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.13662266016028127, "threshold": 0.02}
{"event": "epoch", "epoch": 20, "train_loss": 0.9751649891623242, "val_loss": 1.9131575709374395, "val_f1": 0.3469387725424469, "val_miss": 0.04266211604081003, "val_fpr": 0.8811112049304389, "val_macro_f1": 0.06761743825604469, "gen_f1": 0.28866032820007503, "gen_miss": 0.00769781596847888, "gen_fpr": 0.8850671685375803, "gen_macro_f1": 0.1374040215044979, "threshold": 0.831417727470398}
{"event": "epoch", "epoch": 21, "train_loss": 0.974111227075033, "val_loss": 1.8766356139582319, "val_f1": 0.4590526737928695, "val_miss": 0.29215017064746707, "val_fpr": 0.3404542767876885, "val_macro_f1": 0.06688484275247114, "gen_f1": 0.48107863864219397, "gen_miss": 0.1408879341207646, "gen_fpr": 0.3104030112271042, "gen_macro_f1": 0.1265357696007081, "threshold": 0.8586942434310914}
{"event": "best", "epoch": 21, "val_f1": 0.4590526737928695, "val_miss": 0.29215017064746707, "val_fpr": 0.3404542767876885, "val_macro_f1": 0.06688484275247114, "gen_f1": 0.48107863864219397, "gen_miss": 0.1408879341207646, "gen_fpr": 0.3104030112271042, "gen_macro_f1": 0.1265357696007081, "threshold": 0.8586942434310914}
{"event": "epoch", "epoch": 22, "train_loss": 0.9713338154491421, "val_loss": 1.8902846257333015, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07439706507431126, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.13135450938872492, "threshold": 0.02}
{"event": "epoch", "epoch": 23, "train_loss": 0.9640567134848914, "val_loss": 1.8667801094710412, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07343515344946976, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.13157247273841605, "threshold": 0.02}
{"event": "epoch", "epoch": 24, "train_loss": 0.9582042974926029, "val_loss": 1.851849113895068, "val_f1": 0.34321140434208147, "val_miss": 0.055290102388889796, "val_fpr": 0.8808578907364004, "val_macro_f1": 0.06922960577613836, "gen_f1": 0.2878397686176874, "gen_miss": 0.009488005728590248, "gen_fpr": 0.886689596988485, "gen_macro_f1": 0.12474303003777673, "threshold": 0.8230043411254883}
{"event": "epoch", "epoch": 25, "train_loss": 0.9638693244548274, "val_loss": 1.868264259549991, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07286267679554885, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.13032440272436457, "threshold": 0.02}
{"event": "epoch", "epoch": 26, "train_loss": 0.9610781042743045, "val_loss": 1.842587192904398, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.06998618810665538, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.12674085767386498, "threshold": 0.02}
{"event": "epoch", "epoch": 27, "train_loss": 0.9533200052221584, "val_loss": 1.8430325430102688, "val_f1": 0.3492696707059444, "val_miss": 0.07372013651851973, "val_fpr": 0.8356835261328753, "val_macro_f1": 0.07096050546375549, "gen_f1": 0.3017409158432745, "gen_miss": 0.01485857500892435, "gen_fpr": 0.8237393730933793, "gen_macro_f1": 0.12431126860571445, "threshold": 0.8224761009216308}
{"event": "epoch", "epoch": 28, "train_loss": 0.963228405167538, "val_loss": 1.8525408518174762, "val_f1": 0.33964298260921416, "val_miss": 0.03242320819101562, "val_fpr": 0.9228236088821051, "val_macro_f1": 0.06915228168904283, "gen_f1": 0.2750741815951149, "gen_miss": 0.004296455424267282, "gen_fpr": 0.9504834836780613, "gen_macro_f1": 0.12724802708087038, "threshold": 0.8167470693588257}
{"event": "epoch", "epoch": 29, "train_loss": 0.9558186499109895, "val_loss": 1.8562477392776877, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07056472732255759, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.12682464382041433, "threshold": 0.02}
{"event": "epoch", "epoch": 30, "train_loss": 0.9535624945418737, "val_loss": 1.8394218328996008, "val_f1": 0.34032633737734763, "val_miss": 0.05324232081893092, "val_fpr": 0.8948746094731952, "val_macro_f1": 0.0720887781572541, "gen_f1": 0.2893946098967917, "gen_miss": 0.008592910848534564, "gen_fpr": 0.8809462002722821, "gen_macro_f1": 0.12508522764088806, "threshold": 0.8179811120033265}
{"event": "epoch", "epoch": 31, "train_loss": 0.9590641614902061, "val_loss": 1.8345740935349444, "val_f1": 0.3490051927684943, "val_miss": 0.06006825938546052, "val_fpr": 0.8526555771334521, "val_macro_f1": 0.06998874598855967, "gen_f1": 0.3038030552932934, "gen_miss": 0.014679556032913212, "gen_fpr": 0.815886819391, "gen_macro_f1": 0.12363198111609575, "threshold": 0.8188523411750793}
{"event": "epoch", "epoch": 32, "train_loss": 0.9566995717954287, "val_loss": 1.9015767296803536, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07217797411243036, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.13001021429278206, "threshold": 0.02}
{"event": "epoch", "epoch": 33, "train_loss": 0.964314534707409, "val_loss": 1.8419113183145814, "val_f1": 0.3463198096398312, "val_miss": 0.04129692832750411, "val_fpr": 0.8851642320350542, "val_macro_f1": 0.07061195773710065, "gen_f1": 0.28868667130461534, "gen_miss": 0.008950948800556836, "gen_fpr": 0.883606982931766, "gen_macro_f1": 0.12430255362150895, "threshold": 0.8160848736763}
{"event": "epoch", "epoch": 34, "train_loss": 0.9556344437818685, "val_loss": 1.865017020701555, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07032730716343066, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.12572491653176343, "threshold": 0.02}
{"event": "epoch", "epoch": 35, "train_loss": 0.9557455668370639, "val_loss": 1.8303223977130567, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07018058846684885, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.12489992798073403, "threshold": 0.02}
{"event": "epoch", "epoch": 36, "train_loss": 0.9531475651273874, "val_loss": 1.8748751465262197, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07047806889383852, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.1271143011038072, "threshold": 0.02}
{"event": "epoch", "epoch": 37, "train_loss": 0.951419525116787, "val_loss": 1.8566598069536284, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07162323581025631, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.13223565661222833, "threshold": 0.02}
{"event": "epoch", "epoch": 38, "train_loss": 0.9564387930656493, "val_loss": 1.8807263710661328, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07191398429805086, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.12988449074736758, "threshold": 0.02}
{"event": "epoch", "epoch": 39, "train_loss": 0.9511737376733941, "val_loss": 1.8739747958088715, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07214954129981688, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.129046191170575, "threshold": 0.02}
{"event": "epoch", "epoch": 40, "train_loss": 0.9478220761774551, "val_loss": 1.8668818916019199, "val_f1": 0.3310173389308133, "val_miss": 0.0, "val_fpr": 0.9999999999991556, "val_macro_f1": 0.07088746238320334, "gen_f1": 0.2660633461094779, "gen_miss": 0.0, "gen_fpr": 0.9999999999996755, "gen_macro_f1": 0.12767794271718771, "threshold": 0.02}
{"event": "epoch", "epoch": 41, "train_loss": 0.9507520804875206, "val_loss": 1.851977670103148, "val_f1": 0.4203821615106793, "val_miss": 0.267918088736287, "val_fpr": 0.4331672718057644, "val_macro_f1": 0.06939987607693195, "gen_f1": 0.4668009895278262, "gen_miss": 0.10830648048673773, "gen_fpr": 0.34960088260096384, "gen_macro_f1": 0.12363909657067297, "threshold": 0.846904706954956}
{"event": "epoch", "epoch": 42, "train_loss": 0.9521398758649374, "val_loss": 1.840216426280311, "val_f1": 0.33701363591726463, "val_miss": 0.025938566552812497, "val_fpr": 0.94173773537031, "val_macro_f1": 0.06979968879882603, "gen_f1": 0.2766873125805335, "gen_miss": 0.004475474400278418, "gen_fpr": 0.9426309299756822, "gen_macro_f1": 0.12444433156802165, "threshold": 0.8080962657928467}
{"event": "epoch", "epoch": 43, "train_loss": 0.9533516156489437, "val_loss": 1.814449478057552, "val_f1": 0.33812991955709737, "val_miss": 0.025597269624486017, "val_fpr": 0.9374313940716562, "val_macro_f1": 0.0712219501289401, "gen_f1": 0.2761944965781406, "gen_miss": 0.005012531328311829, "gen_fpr": 0.9443507041336412, "gen_macro_f1": 0.12437986864119227, "threshold": 0.8064167141914368}
{"event": "epoch", "epoch": 44, "train_loss": 0.9504559766526407, "val_loss": 1.8232195547856338, "val_f1": 0.42133385695441156, "val_miss": 0.27337883958951065, "val_fpr": 0.42615891243736703, "val_macro_f1": 0.07062454194946309, "gen_f1": 0.4638059662956329, "gen_miss": 0.10991765127083795, "gen_fpr": 0.3531053280549182, "gen_macro_f1": 0.12322045838296573, "threshold": 0.84361891746521}
{"event": "epoch", "epoch": 45, "train_loss": 0.9493919509295813, "val_loss": 1.8348563700694491, "val_f1": 0.3381435923504772, "val_miss": 0.02832764505109786, "val_fpr": 0.9340538714844768, "val_macro_f1": 0.0699361117369888, "gen_f1": 0.2759647575074317, "gen_miss": 0.004654493376289555, "gen_fpr": 0.9458433383084737, "gen_macro_f1": 0.12371375847015954, "threshold": 0.8078882098197937}
{"event": "epoch", "epoch": 46, "train_loss": 0.9562344862909263, "val_loss": 1.829077911620649, "val_f1": 0.44860412447924, "val_miss": 0.28430034129595805, "val_fpr": 0.3649413155447395, "val_macro_f1": 0.06922839954763, "gen_f1": 0.49506059273086306, "gen_miss": 0.12978875760807412, "gen_fpr": 0.29823479784531826, "gen_macro_f1": 0.11946975146161051, "threshold": 0.8512427568435669}
{"event": "final", "best_threshold": 0.8512427568435669, "val_loss": 1.829077911620649, "val_f1": 0.44860412447924, "val_miss": 0.28430034129595805, "val_fpr": 0.3649413155447395, "gen_loss": 1.773637121961007, "gen_f1": 0.49506059273086306, "gen_miss": 0.12978875760807412, "gen_fpr": 0.29823479784531826, "val_macro_f1": 0.06922839954763, "gen_macro_f1": 0.11946975146161051}

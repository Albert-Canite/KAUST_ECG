{"event": "start", "timestamp": "2025-12-11T22:50:23.379954", "config": {"data_path": "E:/OneDrive - KAUST/ONN codes/MIT-BIH/mit-bih-arrhythmia-database-1.0.0/", "batch_size": 128, "lr": 0.001, "weight_decay": 0.0001, "max_epochs": 90, "patience": 25, "min_epochs": 25, "scheduler_patience": 3, "dropout_rate": 0.2, "num_mlp_layers": 3, "constraint_scale": 1.0, "class_weight_abnormal": 1.35, "class_weight_max_ratio": 2.0, "generalization_score_weight": 0.35, "threshold_target_miss": 0.1, "threshold_max_fpr": 0.1, "threshold_recall_gain": 2.0, "threshold_miss_penalty": 1.25, "threshold_gen_recall_gain": 2.5, "threshold_gen_miss_penalty": 1.35, "seed": 42, "use_value_constraint": true, "use_tanh_activations": false, "use_kd": true, "kd_start_epoch": 5, "kd_alpha": 0.1, "kd_temperature": 2.0, "ema_decay": 0.99, "kd_warmup_epochs": 10}, "class_counts": [39707, 2525], "class_weights": [2.9553844928741455, 11.289742469787598], "data_range": [-1.0, 1.0]}
{"event": "epoch", "epoch": 1, "train_loss": 0.60168638084874, "train_ce_loss": 0.60168638084874, "train_kd_loss": 0.0, "kd_alpha_effective": 0.0, "val_loss": 1.294425994005364, "val_f1": 0.25287356090554675, "val_miss": 0.05203252032435719, "val_fpr": 0.3432565624053673, "gen_f1": 0.5268983535229471, "gen_miss": 0.05081475128634045, "gen_fpr": 0.30708285225134085, "threshold": 0.7474007368087768}
{"event": "best", "epoch": 1, "val_f1": 0.25287356090554675, "val_miss": 0.05203252032435719, "val_fpr": 0.3432565624053673, "gen_f1": 0.5268983535229471, "gen_miss": 0.05081475128634045, "gen_fpr": 0.30708285225134085, "threshold": 0.7474007368087768}
{"event": "epoch", "epoch": 2, "train_loss": 0.46147830377925525, "train_ce_loss": 0.46147830377925525, "train_kd_loss": 0.0, "kd_alpha_effective": 0.0, "val_loss": 1.379726219276606, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02}
{"event": "epoch", "epoch": 3, "train_loss": 0.4893426860823776, "train_ce_loss": 0.4893426860823776, "train_kd_loss": 0.0, "kd_alpha_effective": 0.0, "val_loss": 1.5531909175613745, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02}
{"event": "epoch", "epoch": 4, "train_loss": 0.49213873301491595, "train_ce_loss": 0.49213873301491595, "train_kd_loss": 0.0, "kd_alpha_effective": 0.0, "val_loss": 1.5465396278214785, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02}
{"event": "epoch", "epoch": 5, "train_loss": 0.47898553781437153, "train_ce_loss": 0.4829686117894722, "train_kd_loss": 0.08466074208333862, "kd_alpha_effective": 0.010000000000000002, "val_loss": 1.374694471649203, "val_f1": 0.26932545286973747, "val_miss": 0.11056910568925904, "val_fpr": 0.29166247611355556, "gen_f1": 0.5462962920629554, "gen_miss": 0.1018439108059566, "gen_fpr": 0.2581120356729473, "threshold": 0.7656942248344422}
{"event": "best", "epoch": 5, "val_f1": 0.26932545286973747, "val_miss": 0.11056910568925904, "val_fpr": 0.29166247611355556, "gen_f1": 0.5462962920629554, "gen_miss": 0.1018439108059566, "gen_fpr": 0.2581120356729473, "threshold": 0.7656942248344422}
{"event": "epoch", "epoch": 6, "train_loss": 0.4493666444763993, "train_ce_loss": 0.4582536897876046, "train_kd_loss": 0.01390104444528168, "kd_alpha_effective": 0.020000000000000004, "val_loss": 1.305046398907499, "val_f1": 0.19764158594127224, "val_miss": 0.032520325202723244, "val_fpr": 0.48385799054562617, "gen_f1": 0.4716417873958625, "gen_miss": 0.017581475128607246, "gen_fpr": 0.40546243580029245, "threshold": 0.7236536741256714}
{"event": "epoch", "epoch": 7, "train_loss": 0.45932473440965016, "train_ce_loss": 0.4729441608443405, "train_kd_loss": 0.018962862554260277, "kd_alpha_effective": 0.03, "val_loss": 1.4315139215131176, "val_f1": 0.40460652230163024, "val_miss": 0.14308943089198228, "val_fpr": 0.14713869053590753, "gen_f1": 0.6408489989953294, "gen_miss": 0.26200686106290305, "gen_fpr": 0.10494883943141897, "threshold": 0.7849944829940796}
{"event": "best", "epoch": 7, "val_f1": 0.40460652230163024, "val_miss": 0.14308943089198228, "val_fpr": 0.14713869053590753, "gen_f1": 0.6408489989953294, "gen_miss": 0.26200686106290305, "gen_fpr": 0.10494883943141897, "threshold": 0.7849944829940796}
{"event": "epoch", "epoch": 8, "train_loss": 0.4582354797558351, "train_ce_loss": 0.4769007787559972, "train_kd_loss": 0.010268572328442877, "kd_alpha_effective": 0.04000000000000001, "val_loss": 1.4260188121419892, "val_f1": 0.4327731054074396, "val_miss": 0.16260162601361622, "val_fpr": 0.12571658453170498, "gen_f1": 0.6277012807857368, "gen_miss": 0.26200686106290305, "gen_fpr": 0.11390691563478364, "threshold": 0.7784456253051758}
{"event": "best", "epoch": 8, "val_f1": 0.4327731054074396, "val_miss": 0.16260162601361622, "val_fpr": 0.12571658453170498, "gen_f1": 0.6277012807857368, "gen_miss": 0.26200686106290305, "gen_fpr": 0.11390691563478364, "threshold": 0.7784456253051758}
{"event": "epoch", "epoch": 9, "train_loss": 0.44880017683361517, "train_ce_loss": 0.47186077715772573, "train_kd_loss": 0.010648870435684467, "kd_alpha_effective": 0.05, "val_loss": 1.425280052596228, "val_f1": 0.3819591227476372, "val_miss": 0.11869918698993985, "val_fpr": 0.16906366287823688, "gen_f1": 0.6070573160977367, "gen_miss": 0.18481989708365176, "gen_fpr": 0.1616435083807136, "threshold": 0.7705691456794739}
{"event": "epoch", "epoch": 10, "train_loss": 0.4440321649565841, "train_ce_loss": 0.47163609338529183, "train_kd_loss": 0.01157063219244733, "kd_alpha_effective": 0.06, "val_loss": 1.4137994613040463, "val_f1": 0.36674488442123204, "val_miss": 0.11056910568925904, "val_fpr": 0.18314392034578783, "gen_f1": 0.6078668881226881, "gen_miss": 0.19318181818140398, "gen_fpr": 0.15742325914712846, "threshold": 0.7669073641300201}
{"event": "epoch", "epoch": 11, "train_loss": 0.4349529903946501, "train_ce_loss": 0.46614665714177217, "train_kd_loss": 0.020522795867344196, "kd_alpha_effective": 0.06999999999999999, "val_loss": 1.3945658362302438, "val_f1": 0.38423644980788085, "val_miss": 0.1121951219493952, "val_fpr": 0.16906366287823688, "gen_f1": 0.6062929197773008, "gen_miss": 0.18610634648330596, "gen_fpr": 0.1617231357247435, "threshold": 0.7646278142929077}
{"event": "epoch", "epoch": 12, "train_loss": 0.4340714274933844, "train_ce_loss": 0.47069682840144994, "train_kd_loss": 0.012879219253293493, "kd_alpha_effective": 0.08000000000000002, "val_loss": 1.3963592084300047, "val_f1": 0.3892665439708962, "val_miss": 0.11544715446966752, "val_fpr": 0.1645378658350955, "gen_f1": 0.6048213812810463, "gen_miss": 0.18503430531692747, "gen_fpr": 0.16339530994937157, "threshold": 0.7644849121570587}
{"event": "epoch", "epoch": 13, "train_loss": 0.4290209726853804, "train_ce_loss": 0.47010099562731655, "train_kd_loss": 0.013656164671887051, "kd_alpha_effective": 0.09000000000000001, "val_loss": 1.3898515546834476, "val_f1": 0.3932993410221662, "val_miss": 0.12195121951021218, "val_fpr": 0.16001206879195412, "gen_f1": 0.588524325660753, "gen_miss": 0.20390222984518888, "gen_fpr": 0.16884978301542028, "threshold": 0.7651364207267761}
{"event": "epoch", "epoch": 14, "train_loss": 0.42457560056989846, "train_ce_loss": 0.470156432372151, "train_kd_loss": 0.014348214243849118, "kd_alpha_effective": 0.1, "val_loss": 1.3919812268798923, "val_f1": 0.3410900153120987, "val_miss": 0.09430894308789742, "val_fpr": 0.2106004224075122, "gen_f1": 0.5616719757372405, "gen_miss": 0.15008576329298867, "gen_fpr": 0.2184576183460531, "threshold": 0.7560989856719971}
{"event": "epoch", "epoch": 15, "train_loss": 0.4244387876806837, "train_ce_loss": 0.46995604814905106, "train_kd_loss": 0.01478354459007581, "kd_alpha_effective": 0.1, "val_loss": 1.3744591766289858, "val_f1": 0.393000361082715, "val_miss": 0.12357723577034833, "val_fpr": 0.15981092225670337, "gen_f1": 0.5848981809031977, "gen_miss": 0.20861921097725425, "gen_fpr": 0.16984512481579414, "threshold": 0.7589975297451019}
{"event": "epoch", "epoch": 16, "train_loss": 0.4233348294641032, "train_ce_loss": 0.4686758096470977, "train_kd_loss": 0.01526610670667706, "kd_alpha_effective": 0.1, "val_loss": 1.371320306520883, "val_f1": 0.4001476524490056, "val_miss": 0.11869918698993985, "val_fpr": 0.15608971135456493, "gen_f1": 0.5855393078693506, "gen_miss": 0.20561749571139448, "gen_fpr": 0.17064139825609323, "threshold": 0.7593094706535339}
{"event": "epoch", "epoch": 17, "train_loss": 0.42534666549075734, "train_ce_loss": 0.4708311549641869, "train_kd_loss": 0.015986364464642425, "kd_alpha_effective": 0.1, "val_loss": 1.3754724032681511, "val_f1": 0.38004917117998127, "val_miss": 0.12032520325007601, "val_fpr": 0.17006939555449052, "gen_f1": 0.6028601055736443, "gen_miss": 0.191037735848647, "gen_fpr": 0.16243978182101268, "threshold": 0.7736837267875671}
{"event": "epoch", "epoch": 18, "train_loss": 0.42489390192609844, "train_ce_loss": 0.4703113949660099, "train_kd_loss": 0.016136570348206796, "kd_alpha_effective": 0.1, "val_loss": 1.3657420901643391, "val_f1": 0.4007448754224595, "val_miss": 0.1252032520304845, "val_fpr": 0.15407824600205763, "gen_f1": 0.5831690149871129, "gen_miss": 0.20733276157760006, "gen_fpr": 0.17191543576057175, "threshold": 0.7619194388389587}
{"event": "epoch", "epoch": 19, "train_loss": 0.4234293854597843, "train_ce_loss": 0.46863649930014756, "train_kd_loss": 0.016565469330684705, "kd_alpha_effective": 0.1, "val_loss": 1.363125540086053, "val_f1": 0.3953403678361211, "val_miss": 0.11707317072980368, "val_fpr": 0.15981092225670337, "gen_f1": 0.5922168456201982, "gen_miss": 0.19897084047984784, "gen_fpr": 0.1678942548870614, "threshold": 0.7584275305271149}
{"event": "epoch", "epoch": 20, "train_loss": 0.42336269797700826, "train_ce_loss": 0.46853385233517847, "train_kd_loss": 0.01682239839750709, "kd_alpha_effective": 0.1, "val_loss": 1.3581184687364234, "val_f1": 0.40343027237598855, "val_miss": 0.12032520325007601, "val_fpr": 0.15347480639630545, "gen_f1": 0.5852389166545849, "gen_miss": 0.2043310463117403, "gen_fpr": 0.17147748536840726, "threshold": 0.7565779089927673}
{"event": "epoch", "epoch": 21, "train_loss": 0.42383335901029184, "train_ce_loss": 0.4690094215400291, "train_kd_loss": 0.017248910287338676, "kd_alpha_effective": 0.1, "val_loss": 1.3567682978419966, "val_f1": 0.40208100724748985, "val_miss": 0.12032520325007601, "val_fpr": 0.15437996580493374, "gen_f1": 0.5892843005632232, "gen_miss": 0.19939965694639925, "gen_fpr": 0.17020344786392871, "threshold": 0.7586790919303894}
{"event": "epoch", "epoch": 22, "train_loss": 0.42203817304336666, "train_ce_loss": 0.4669954690969352, "train_kd_loss": 0.017422609358574405, "kd_alpha_effective": 0.1, "val_loss": 1.3576795463422908, "val_f1": 0.34381679084057853, "val_miss": 0.08455284552708044, "val_fpr": 0.2109021422103883, "gen_f1": 0.5597617990607439, "gen_miss": 0.15351629502539985, "gen_fpr": 0.21873631405015775, "threshold": 0.7482440352439881}
{"event": "epoch", "epoch": 23, "train_loss": 0.42410230988805947, "train_ce_loss": 0.4692609266801314, "train_kd_loss": 0.017674861303671744, "kd_alpha_effective": 0.1, "val_loss": 1.35588920638064, "val_f1": 0.34529702661930556, "val_miss": 0.09268292682776125, "val_fpr": 0.20708035804062447, "gen_f1": 0.5572125194329756, "gen_miss": 0.15480274442505404, "gen_fpr": 0.2206871839788905, "threshold": 0.7476742029190063}
{"event": "epoch", "epoch": 24, "train_loss": 0.4250157148549051, "train_ce_loss": 0.47026053865750633, "train_kd_loss": 0.01781240361037128, "kd_alpha_effective": 0.1, "val_loss": 1.3509416046818226, "val_f1": 0.3489388233626643, "val_miss": 0.09105691056762509, "val_fpr": 0.20416373327948892, "gen_f1": 0.5551244930095567, "gen_miss": 0.1563036020579839, "gen_fpr": 0.2220806624994139, "threshold": 0.7462663769721984}
{"event": "epoch", "epoch": 25, "train_loss": 0.42486278505036323, "train_ce_loss": 0.47009146358027604, "train_kd_loss": 0.017804790240232692, "kd_alpha_effective": 0.1, "val_loss": 1.3487561851948766, "val_f1": 0.3512836537449347, "val_miss": 0.08780487804735276, "val_fpr": 0.20295685406798453, "gen_f1": 0.5569887881423005, "gen_miss": 0.15287307032557274, "gen_fpr": 0.22184178046732417, "threshold": 0.7460404753684997}
{"event": "epoch", "epoch": 26, "train_loss": 0.42590666702299407, "train_ce_loss": 0.47124582890308264, "train_kd_loss": 0.01785431360600121, "kd_alpha_effective": 0.1, "val_loss": 1.34724167694443, "val_f1": 0.3478799102551124, "val_miss": 0.0861788617872166, "val_fpr": 0.20657749170249765, "gen_f1": 0.5584452252618356, "gen_miss": 0.15287307032557274, "gen_fpr": 0.22036867460277088, "threshold": 0.7457056522369385}
{"event": "epoch", "epoch": 27, "train_loss": 0.4261366095506784, "train_ce_loss": 0.47149575741002053, "train_kd_loss": 0.01790437497988795, "kd_alpha_effective": 0.1, "val_loss": 1.3449522815524775, "val_f1": 0.34898911043418274, "val_miss": 0.08780487804735276, "val_fpr": 0.20506889268811718, "gen_f1": 0.5572497485119491, "gen_miss": 0.15373070325867555, "gen_fpr": 0.22116494804306996, "threshold": 0.7451123356819153}
{"event": "epoch", "epoch": 28, "train_loss": 0.42564409619027915, "train_ce_loss": 0.4709412760806806, "train_kd_loss": 0.01796957982252493, "kd_alpha_effective": 0.1, "val_loss": 1.3443548304268211, "val_f1": 0.34651018839692227, "val_miss": 0.08780487804735276, "val_fpr": 0.20738207784350055, "gen_f1": 0.5590044500792039, "gen_miss": 0.15244425385902136, "gen_fpr": 0.2200103515546363, "threshold": 0.745026433467865}
{"event": "epoch", "epoch": 29, "train_loss": 0.42703293336160253, "train_ce_loss": 0.47248008224097165, "train_kd_loss": 0.0180086953113928, "kd_alpha_effective": 0.1, "val_loss": 1.340632178539985, "val_f1": 0.35051546081104584, "val_miss": 0.08780487804735276, "val_fpr": 0.2036608669413621, "gen_f1": 0.5559943538356823, "gen_miss": 0.15480274442505404, "gen_fpr": 0.22192140781135408, "threshold": 0.7440091490745544}
{"event": "epoch", "epoch": 30, "train_loss": 0.42701993133082533, "train_ce_loss": 0.4724440588192506, "train_kd_loss": 0.018202877465183988, "kd_alpha_effective": 0.1, "val_loss": 1.3399986269167368, "val_f1": 0.348663763220544, "val_miss": 0.08780487804735276, "val_fpr": 0.20537061249099328, "gen_f1": 0.5560968677135353, "gen_miss": 0.15566037735815683, "gen_fpr": 0.22140383007515968, "threshold": 0.743852150440216}
{"event": "epoch", "epoch": 31, "train_loss": 0.4264749666958144, "train_ce_loss": 0.4718295089223168, "train_kd_loss": 0.018284198133782906, "kd_alpha_effective": 0.1, "val_loss": 1.3400079232315423, "val_f1": 0.3503924615598215, "val_miss": 0.09268292682776125, "val_fpr": 0.20235341446223234, "gen_f1": 0.5553677048010289, "gen_miss": 0.15480274442505404, "gen_fpr": 0.22255842656359334, "threshold": 0.743831193447113}
{"event": "epoch", "epoch": 32, "train_loss": 0.42706705864631767, "train_ce_loss": 0.47249261086637323, "train_kd_loss": 0.01823719430601958, "kd_alpha_effective": 0.1, "val_loss": 1.3394630052845098, "val_f1": 0.35113065014722444, "val_miss": 0.09105691056762509, "val_fpr": 0.20215226792698163, "gen_f1": 0.5563147099636001, "gen_miss": 0.15330188679212414, "gen_fpr": 0.22231954453150363, "threshold": 0.7437243103981018}
{"event": "epoch", "epoch": 33, "train_loss": 0.4270401772224542, "train_ce_loss": 0.472432346145312, "train_kd_loss": 0.018510755174087755, "kd_alpha_effective": 0.1, "val_loss": 1.339618407431189, "val_f1": 0.349968805381311, "val_miss": 0.08780487804735276, "val_fpr": 0.20416373327948892, "gen_f1": 0.5577424999929991, "gen_miss": 0.15244425385902136, "gen_fpr": 0.22128438905911482, "threshold": 0.7438408732414246}
{"event": "final", "best_threshold": 0.7438408732414246, "val_loss": 1.339618407431189, "val_f1": 0.349968805381311, "val_miss": 0.08780487804735276, "val_fpr": 0.20416373327948892, "gen_loss": 1.2266818245079851, "gen_f1": 0.5577424999929991, "gen_miss": 0.15244425385902136, "gen_fpr": 0.22128438905911482}

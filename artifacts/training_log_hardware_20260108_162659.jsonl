{"event": "start", "timestamp": "2026-01-08T16:27:09.372945", "config": {"data_path": "E:/OneDrive - KAUST/ONN codes/MIT-BIH/mit-bih-arrhythmia-database-1.0.0/", "batch_size": 128, "lr": 0.001, "weight_decay": 0.0001, "max_epochs": 90, "patience": 25, "min_epochs": 25, "scheduler_patience": 3, "dropout_rate": 0.2, "num_mlp_layers": 3, "constraint_scale": 1.0, "class_weight_abnormal": 1.35, "class_weight_max_ratio": 2.0, "generalization_score_weight": 0.35, "threshold_target_miss": 0.1, "threshold_max_fpr": 0.1, "threshold_recall_gain": 2.0, "threshold_miss_penalty": 1.25, "threshold_gen_recall_gain": 2.5, "threshold_gen_miss_penalty": 1.35, "gen_threshold": null, "gen_threshold_target_miss": null, "gen_threshold_max_fpr": null, "gen_threshold_tighten_factor": 0.7, "gen_threshold_fpr_relax_factor": 1.25, "seed": 42, "input_bits": 5, "weight_bits": 5, "snr_min": 10.0, "snr_max": 30.0, "pbr_min": 0.5, "pbr_max": 0.9, "pbr_peak_window": 12, "pbr_min_prominence": 0.05, "weight_target": 1.0, "weight_target_strength": 0.0001, "hardware_prob": 1.0, "hardware_eval": true, "use_value_constraint": true, "use_tanh_activations": false}, "class_counts": [39707, 2525], "class_weights": [2.9553844928741455, 11.289742469787598], "data_range": [-1.0, 1.0]}
{"event": "epoch", "epoch": 1, "train_loss": 0.6095401176900574, "val_loss": 1.1355624656420717, "val_f1": 0.23168124182033606, "val_miss": 0.030894308942587084, "val_fpr": 0.39565523483818194, "gen_f1": 0.4864657915732941, "gen_miss": 0.04631217838755079, "gen_fpr": 0.36529044073720374, "threshold": 0.6950065851211548}
{"event": "best", "epoch": 1, "val_f1": 0.23168124182033606, "val_miss": 0.030894308942587084, "val_fpr": 0.39565523483818194, "gen_f1": 0.4864657915732941, "gen_miss": 0.04631217838755079, "gen_fpr": 0.36529044073720374, "threshold": 0.6950065851211548}
{"event": "epoch", "epoch": 2, "train_loss": 0.4529151745817878, "val_loss": 0.8709429458452684, "val_f1": 0.2679889274536948, "val_miss": 0.05528455284462952, "val_fpr": 0.31580006034364294, "gen_f1": 0.540843369452861, "gen_miss": 0.03752144082324717, "gen_fpr": 0.2964924154953631, "threshold": 0.548}
{"event": "best", "epoch": 2, "val_f1": 0.2679889274536948, "val_miss": 0.05528455284462952, "val_fpr": 0.31580006034364294, "gen_f1": 0.540843369452861, "gen_miss": 0.03752144082324717, "gen_fpr": 0.2964924154953631, "threshold": 0.548}
{"event": "epoch", "epoch": 3, "train_loss": 0.4301858975128694, "val_loss": 0.9775198013589653, "val_f1": 0.2588754111053691, "val_miss": 0.045528455283812545, "val_fpr": 0.3352107009953382, "gen_f1": 0.5370853040570398, "gen_miss": 0.02808747855911645, "gen_fpr": 0.3058884420908923, "threshold": 0.5913207173347473}
{"event": "epoch", "epoch": 4, "train_loss": 0.41081424138762734, "val_loss": 0.7920341960948895, "val_f1": 0.26185201359560245, "val_miss": 0.0390243902432679, "val_fpr": 0.3326963693047041, "gen_f1": 0.532394528871126, "gen_miss": 0.03537735849049019, "gen_fpr": 0.3080781940517147, "threshold": 0.4465589046478271}
{"event": "epoch", "epoch": 5, "train_loss": 0.3938423678730473, "val_loss": 0.6888976418784587, "val_f1": 0.3046007376240191, "val_miss": 0.06341463414531033, "val_fpr": 0.2605853364173181, "gen_f1": 0.58056450656836, "gen_miss": 0.05403087478547592, "gen_fpr": 0.2437791137475639, "threshold": 0.5}
{"event": "best", "epoch": 5, "val_f1": 0.3046007376240191, "val_miss": 0.06341463414531033, "val_fpr": 0.2605853364173181, "gen_f1": 0.58056450656836, "gen_miss": 0.05403087478547592, "gen_fpr": 0.2437791137475639, "threshold": 0.5}
{"event": "epoch", "epoch": 6, "train_loss": 0.3809323511340401, "val_loss": 0.767582372161199, "val_f1": 0.264184394807457, "val_miss": 0.030894308942587084, "val_fpr": 0.3319923564313265, "gen_f1": 0.5489183833238459, "gen_miss": 0.042452830188588225, "gen_fpr": 0.2843492455308021, "threshold": 0.548}
{"event": "epoch", "epoch": 7, "train_loss": 0.3464111391793598, "val_loss": 0.5901127153216132, "val_f1": 0.27697337446544645, "val_miss": 0.03577235772299557, "val_fpr": 0.3091622246803689, "gen_f1": 0.5626575853588611, "gen_miss": 0.043096054888415315, "gen_fpr": 0.2682247083647457, "threshold": 0.35600000000000004}
{"event": "epoch", "epoch": 8, "train_loss": 0.31831752946882536, "val_loss": 0.6340202645362157, "val_f1": 0.26777677529181537, "val_miss": 0.032520325202723244, "val_fpr": 0.32525394750042713, "gen_f1": 0.5516251752355663, "gen_miss": 0.052101200685994636, "gen_fpr": 0.2764661384718412, "threshold": 0.35600000000000004}
{"event": "epoch", "epoch": 9, "train_loss": 0.3160749845884063, "val_loss": 0.6045602941901468, "val_f1": 0.27371765533622083, "val_miss": 0.01951219512163395, "val_fpr": 0.3206275771896604, "gen_f1": 0.5454658886513873, "gen_miss": 0.06303602058305524, "gen_fpr": 0.2782577537125141, "threshold": 0.26}
{"event": "epoch", "epoch": 10, "train_loss": 0.3104504373940555, "val_loss": 0.5573450686986258, "val_f1": 0.26083207357736904, "val_miss": 0.016260162601361622, "val_fpr": 0.3438600020111195, "gen_f1": 0.5247681755277193, "gen_miss": 0.07783018867907841, "gen_fpr": 0.295696142055064, "threshold": 0.116}
{"event": "epoch", "epoch": 11, "train_loss": 0.30647200856244927, "val_loss": 0.5815183291337689, "val_f1": 0.2816967399735546, "val_miss": 0.022764227641906273, "val_fpr": 0.30684903952498555, "gen_f1": 0.5440119906221247, "gen_miss": 0.06646655231546642, "gen_fpr": 0.2782577537125141, "threshold": 0.30800000000000005}
{"event": "epoch", "epoch": 12, "train_loss": 0.3121725549300512, "val_loss": 0.5208400608599468, "val_f1": 0.2827995230104403, "val_miss": 0.030894308942587084, "val_fpr": 0.30212209594659345, "gen_f1": 0.546372872919792, "gen_miss": 0.07225557461391026, "gen_fpr": 0.2726440259584056, "threshold": 0.26}
{"event": "epoch", "epoch": 13, "train_loss": 0.30465868688894043, "val_loss": 0.7161557257435136, "val_f1": 0.2738664819817808, "val_miss": 0.022764227641906273, "val_fpr": 0.31911897817527995, "gen_f1": 0.5415820211443647, "gen_miss": 0.05681818181806, "gen_fpr": 0.2859417924114003, "threshold": 0.5}
{"event": "epoch", "epoch": 14, "train_loss": 0.3072718169653054, "val_loss": 0.7497130440229447, "val_f1": 0.27384755577836367, "val_miss": 0.024390243902042436, "val_fpr": 0.31851553856952775, "gen_f1": 0.5428943572790877, "gen_miss": 0.061749571183401054, "gen_fpr": 0.2819206115378899, "threshold": 0.5960000000000001}
{"event": "epoch", "epoch": 15, "train_loss": 0.3100328422405503, "val_loss": 0.75977304578392, "val_f1": 0.2901883996929447, "val_miss": 0.03577235772299557, "val_fpr": 0.28955043749342296, "gen_f1": 0.5510719564018479, "gen_miss": 0.08790737564303622, "gen_fpr": 0.2596249552095156, "threshold": 0.788}
{"event": "epoch", "epoch": 16, "train_loss": 0.30596556704152716, "val_loss": 0.7168719610225796, "val_f1": 0.25620529854565893, "val_miss": 0.009756097560816974, "val_fpr": 0.3550236347175349, "gen_f1": 0.5121334060797852, "gen_miss": 0.0452401372211723, "gen_fpr": 0.3293785085797152, "threshold": 0.35600000000000004}
{"event": "epoch", "epoch": 17, "train_loss": 0.2983278418580691, "val_loss": 0.6088024837136562, "val_f1": 0.27711941417920777, "val_miss": 0.011382113820953136, "val_fpr": 0.318314392034277, "gen_f1": 0.5280575499275808, "gen_miss": 0.05574614065168151, "gen_fpr": 0.3030616713778305, "threshold": 0.164}
{"event": "epoch", "epoch": 18, "train_loss": 0.2962738168962074, "val_loss": 0.5939653519541731, "val_f1": 0.29687108625470704, "val_miss": 0.03577235772299557, "val_fpr": 0.28029769687188943, "gen_f1": 0.5484736195231866, "gen_miss": 0.0793310463120083, "gen_fpr": 0.26675160250019236, "threshold": 0.404}
{"event": "epoch", "epoch": 19, "train_loss": 0.297412905413093, "val_loss": 0.7028957479468438, "val_f1": 0.2767672091725151, "val_miss": 0.022764227641906273, "val_fpr": 0.3144926078645132, "gen_f1": 0.5417236620918818, "gen_miss": 0.06603773584891502, "gen_fpr": 0.2811641517696058, "threshold": 0.5960000000000001}
{"event": "epoch", "epoch": 20, "train_loss": 0.29448083625598387, "val_loss": 0.5976505197230377, "val_f1": 0.29414657883781237, "val_miss": 0.02764227642231476, "val_fpr": 0.28693553253516346, "gen_f1": 0.5467001844157136, "gen_miss": 0.0675385934818449, "gen_fpr": 0.27459489588713837, "threshold": 0.30800000000000005}
{"event": "epoch", "epoch": 21, "train_loss": 0.29327171219117715, "val_loss": 0.6544314502630977, "val_f1": 0.2880952355941213, "val_miss": 0.016260162601361622, "val_fpr": 0.2997083375235847, "gen_f1": 0.5638304713593466, "gen_miss": 0.06582332761563932, "gen_fpr": 0.2561611657442146, "threshold": 0.30800000000000005}
{"event": "epoch", "epoch": 22, "train_loss": 0.30040389814160084, "val_loss": 0.6769267162786196, "val_f1": 0.2929841871449706, "val_miss": 0.03577235772299557, "val_fpr": 0.28562808005603374, "gen_f1": 0.5649511358339568, "gen_miss": 0.07032590051442898, "gen_fpr": 0.2528168172949585, "threshold": 0.6468084752559664}
{"event": "epoch", "epoch": 23, "train_loss": 0.2954171074610768, "val_loss": 0.5873659743709893, "val_f1": 0.29770229510071977, "val_miss": 0.030894308942587084, "val_fpr": 0.28090113647764164, "gen_f1": 0.5594450884812466, "gen_miss": 0.07482847341321863, "gen_fpr": 0.25667874348040903, "threshold": 0.35600000000000004}
{"event": "epoch", "epoch": 24, "train_loss": 0.29407920674844223, "val_loss": 0.6628181885241288, "val_f1": 0.28805789855710706, "val_miss": 0.02926829268245092, "val_fpr": 0.29498139394519257, "gen_f1": 0.549504946326556, "gen_miss": 0.07182675814735887, "gen_fpr": 0.2692598638371345, "threshold": 0.5}
{"event": "epoch", "epoch": 25, "train_loss": 0.2937923381725947, "val_loss": 0.7154187280631783, "val_f1": 0.2631808255648749, "val_miss": 0.017886178861497785, "val_fpr": 0.33903248516510204, "gen_f1": 0.5385458490562424, "gen_miss": 0.05188679245271894, "gen_fpr": 0.2920730979017032, "threshold": 0.164}
{"event": "epoch", "epoch": 26, "train_loss": 0.2983443622336243, "val_loss": 0.5725639465463096, "val_f1": 0.297069048577489, "val_miss": 0.02764227642231476, "val_fpr": 0.28291260183014894, "gen_f1": 0.5633619525768088, "gen_miss": 0.07161234991408316, "gen_fpr": 0.25393160011137716, "threshold": 0.2604772686958314}
{"event": "epoch", "epoch": 27, "train_loss": 0.298491662198847, "val_loss": 0.6122335363437019, "val_f1": 0.2908472904905736, "val_miss": 0.026016260162178596, "val_fpr": 0.2921653424516824, "gen_f1": 0.5503822057106487, "gen_miss": 0.06603773584891502, "gen_fpr": 0.2710912927498224, "threshold": 0.26}
{"event": "epoch", "epoch": 28, "train_loss": 0.29918204175703456, "val_loss": 0.6212880109257037, "val_f1": 0.2960935530172339, "val_miss": 0.032520325202723244, "val_fpr": 0.28251030875964744, "gen_f1": 0.5685171663796487, "gen_miss": 0.0789022298454569, "gen_fpr": 0.2449735239080125, "threshold": 0.404}
{"event": "epoch", "epoch": 29, "train_loss": 0.2952292471220999, "val_loss": 0.60031848223423, "val_f1": 0.2967519659339096, "val_miss": 0.01951219512163395, "val_fpr": 0.28623151966178595, "gen_f1": 0.563323329534423, "gen_miss": 0.07397084048011585, "gen_fpr": 0.2528566309669734, "threshold": 0.22468645870685588}
{"event": "epoch", "epoch": 30, "train_loss": 0.2989764576156934, "val_loss": 0.6005773856730641, "val_f1": 0.2805722172219137, "val_miss": 0.011382113820953136, "val_fpr": 0.31288343558250736, "gen_f1": 0.5389586595070057, "gen_miss": 0.05231560891927034, "gen_fpr": 0.291356451805434, "threshold": 0.068}
{"event": "final", "best_threshold": 0.116, "gen_threshold": 0.012566859833896145, "gen_threshold_source": "auto_sweep", "val_loss": 0.6326213704408356, "val_f1": 0.2776882315073025, "val_miss": 0.01951219512163395, "val_fpr": 0.3142914613292625, "gen_loss": 0.5365133792232766, "gen_f1": 0.5021587474145656, "gen_miss": 0.027444253859289357, "gen_fpr": 0.35298801608458297, "gen_threshold_options": {"low_miss": {"threshold": 0.8707, "metrics": {"sensitivity": 0.8732847341319183, "specificity": 0.8000159254684874, "precision": 0.44777924362307847, "f1": 0.5920058094713474, "miss_rate": 0.12671526586593757, "fpr": 0.1999840745311144, "tp": 4073, "tn": 20094, "fp": 5023, "fn": 591}}, "balanced": {"threshold": 0.6735, "metrics": {"sensitivity": 0.900514579757932, "specificity": 0.7776406417960833, "precision": 0.4292284108324688, "f1": 0.581355106707611, "miss_rate": 0.09948542023992392, "fpr": 0.22235935820351857, "tp": 4200, "tn": 19532, "fp": 5585, "fn": 464}}, "low_fpr": {"threshold": 0.6761, "metrics": {"sensitivity": 0.9000857632913807, "specificity": 0.7777202691401132, "precision": 0.42919946835657985, "f1": 0.581239178734968, "miss_rate": 0.09991423670647531, "fpr": 0.22227973085948868, "tp": 4198, "tn": 19534, "fp": 5583, "fn": 466}}}, "gen_threshold_sweep": {"sweep_csv": "artifacts\\gen_threshold_sweep_hardware.csv", "low_miss_candidate_count": 1294, "low_miss_top10": [{"threshold": 0.8707, "miss_rate": 0.12671526586593757, "fpr": 0.1999840745311144, "roc": 0.673300659600804}, {"threshold": 0.8708, "miss_rate": 0.12671526586593757, "fpr": 0.1999840745311144, "roc": 0.673300659600804}, {"threshold": 0.8715, "miss_rate": 0.12692967409921327, "fpr": 0.19986463351506953, "roc": 0.6732056923835731}, {"threshold": 0.8716, "miss_rate": 0.12692967409921327, "fpr": 0.19986463351506953, "roc": 0.6732056923835731}, {"threshold": 0.8711, "miss_rate": 0.12692967409921327, "fpr": 0.19990444718708447, "roc": 0.6731658787115582}, {"threshold": 0.8712, "miss_rate": 0.12692967409921327, "fpr": 0.19990444718708447, "roc": 0.6731658787115582}, {"threshold": 0.8713, "miss_rate": 0.12692967409921327, "fpr": 0.19990444718708447, "roc": 0.6731658787115582}, {"threshold": 0.8714, "miss_rate": 0.12692967409921327, "fpr": 0.19990444718708447, "roc": 0.6731658787115582}, {"threshold": 0.8709, "miss_rate": 0.12692967409921327, "fpr": 0.19994426085909944, "roc": 0.6731260650395432}, {"threshold": 0.871, "miss_rate": 0.12692967409921327, "fpr": 0.19994426085909944, "roc": 0.6731260650395432}], "low_fpr_candidate_count": 6763, "low_fpr_top10": [{"threshold": 0.6761, "miss_rate": 0.09991423670647531, "fpr": 0.22227973085948868, "roc": 0.677806032431892}, {"threshold": 0.6762, "miss_rate": 0.09991423670647531, "fpr": 0.22227973085948868, "roc": 0.677806032431892}, {"threshold": 0.6756, "miss_rate": 0.09969982847319962, "fpr": 0.22231954453150363, "roc": 0.6779806269931528}, {"threshold": 0.6757, "miss_rate": 0.09969982847319962, "fpr": 0.22231954453150363, "roc": 0.6779806269931528}, {"threshold": 0.6758, "miss_rate": 0.09969982847319962, "fpr": 0.22231954453150363, "roc": 0.6779806269931528}, {"threshold": 0.6759, "miss_rate": 0.09969982847319962, "fpr": 0.22231954453150363, "roc": 0.6779806269931528}, {"threshold": 0.676, "miss_rate": 0.09969982847319962, "fpr": 0.22231954453150363, "roc": 0.6779806269931528}, {"threshold": 0.6735, "miss_rate": 0.09948542023992392, "fpr": 0.22235935820351857, "roc": 0.6781552215544134}, {"threshold": 0.6736, "miss_rate": 0.09948542023992392, "fpr": 0.22235935820351857, "roc": 0.6781552215544134}, {"threshold": 0.6737, "miss_rate": 0.09948542023992392, "fpr": 0.22235935820351857, "roc": 0.6781552215544134}], "balanced": {"threshold": 0.6735, "miss_rate": 0.09948542023992392, "fpr": 0.22235935820351857, "roc": 0.6781552215544134}}}

{"event": "start", "timestamp": "2026-01-10T12:43:12.671093", "config": {"data_path": "E:/OneDrive - KAUST/ONN codes/MIT-BIH/mit-bih-arrhythmia-database-1.0.0/", "batch_size": 128, "lr": 0.001, "weight_decay": 0.0001, "max_epochs": 90, "patience": 25, "min_epochs": 25, "scheduler_patience": 3, "dropout_rate": 0, "num_mlp_layers": 3, "constraint_scale": 1.0, "class_weight_abnormal": 1.35, "class_weight_max_ratio": 2.0, "selection_metric": "balanced_norm", "selection_miss_weight": 1.0, "selection_fpr_weight": 1.0, "selection_auto_weights": true, "best_metric": "selection", "early_stop_metric": "best_metric", "generalization_score_weight": 0.35, "threshold_target_miss": 0.1, "threshold_max_fpr": 0.18, "threshold_recall_gain": 2.0, "threshold_miss_penalty": 1.25, "threshold_gen_recall_gain": 2.5, "threshold_gen_miss_penalty": 1.35, "gen_threshold": null, "gen_threshold_target_miss": null, "gen_threshold_max_fpr": null, "gen_threshold_tighten_factor": 0.7, "gen_threshold_fpr_relax_factor": 1.25, "seed": 42, "input_bits": 5, "weight_bits": 5, "snr_min": 5.0, "snr_max": 25.0, "pbr_min": 0.5, "pbr_max": 0.9, "pbr_peak_window": 12, "pbr_min_prominence": 0.05, "fixed_eval_hardware": true, "eval_fixed_snr": 15, "eval_fixed_pbr": 0.6, "eval_fixed_seed": 1234, "weight_target": 1.0, "weight_reg_mode": "repel_zero", "weight_zero_epsilon": 0.001, "weight_target_strength": 1e-05, "weight_target_strength_stage2": 0.0001, "weight_target_stage1_epochs": 5, "weight_target_ramp_epochs": 20, "weight_dist_score_weight": 0.1, "save_require_threshold_targets": true, "weight_strength_sweep": "5e-5,8e-5,1e-4", "use_bias": false, "use_constrained_classifier": true, "hardware_prob": 1.0, "hardware_warmup_epochs": 10, "hardware_prob_start": 0.4, "snr_min_start": 15.0, "snr_max_start": 35.0, "pbr_min_start": 0.8, "pbr_max_start": 0.95, "renormalize_inputs": true, "zero_mean_inputs": true, "hardware_eval": true, "use_value_constraint": true, "use_tanh_activations": false}, "class_counts": [39707, 2525], "class_weights": [2.9553844928741455, 11.289742469787598], "data_range": [-1.0, 1.0]}
{"event": "epoch", "epoch": 1, "train_loss": 0.6790057464079423, "val_loss": 0.7489105947068705, "val_f1": 0.12166050025430003, "val_miss": 0.037398373983131734, "val_fpr": 0.8573871065062281, "avg_reg_loss": 32.49680616783373, "gen_f1": 0.2715087073976825, "gen_miss": 0.014150943396196075, "gen_fpr": 0.9797348409439902, "threshold": 0.5236629843711853, "selection_score": -33.33042253046657, "best_metric_score": -33.33042253046657}
{"event": "epoch", "epoch": 2, "train_loss": 0.6014873504638671, "val_loss": 0.8871005399815624, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "avg_reg_loss": 35.317548211415605, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02, "selection_score": -34.28586553658271, "best_metric_score": -34.28586553658271}
{"event": "epoch", "epoch": 3, "train_loss": 0.4828977869315581, "val_loss": 1.1016485402926868, "val_f1": 0.14333096287528893, "val_miss": 0.016260162601361622, "val_fpr": 0.7263401387903787, "avg_reg_loss": 33.039040207140374, "gen_f1": 0.3015665769431189, "gen_miss": 0.05896226415081698, "gen_fpr": 0.7984631922599043, "threshold": 0.6524457335472107, "selection_score": -27.20449483619648, "best_metric_score": -27.20449483619648}
{"event": "epoch", "epoch": 4, "train_loss": 0.44210216240449385, "val_loss": 1.1692628670560747, "val_f1": 0.1739506690880726, "val_miss": 0.01951219512163395, "val_fpr": 0.5747762244789553, "avg_reg_loss": 34.46646962021337, "gen_f1": 0.36424325996997775, "gen_miss": 0.04073756432238264, "gen_fpr": 0.6142453318467117, "threshold": 0.685596126317978, "selection_score": -22.963922733459476, "best_metric_score": -22.963922733459476}
{"event": "epoch", "epoch": 5, "train_loss": 0.4238367654157407, "val_loss": 1.21016336661619, "val_f1": 0.329014081640638, "val_miss": 0.05040650406422103, "val_fpr": 0.23644775218723074, "avg_reg_loss": 47.27801710186583, "gen_f1": 0.5185512325947466, "gen_miss": 0.11899656946801244, "gen_fpr": 0.28168172950580017, "threshold": 0.7403925001621247, "selection_score": -16.737208164203565, "best_metric_score": -16.737208164203565}
{"event": "epoch", "epoch": 6, "train_loss": 0.4127912878990173, "val_loss": 1.245415407975846, "val_f1": 0.32202008953229866, "val_miss": 0.03577235772299557, "val_fpr": 0.2489188373727759, "avg_reg_loss": 72.6650180123069, "gen_f1": 0.559847275494308, "gen_miss": 0.05681818181806, "gen_fpr": 0.2648405462434746, "threshold": 0.7508835256099701, "selection_score": -18.204397649824365, "best_metric_score": -18.204397649824365}
{"event": "epoch", "epoch": 7, "train_loss": 0.4067755654002681, "val_loss": 1.2511911936207327, "val_f1": 0.39497794036611744, "val_miss": 0.053658536584493356, "val_fpr": 0.17600321834438698, "avg_reg_loss": 68.41366754011675, "gen_f1": 0.5873631659172399, "gen_miss": 0.09112349914217169, "gen_fpr": 0.22020941991471107, "threshold": 0.7626003980636596, "selection_score": -17.244440569143876, "best_metric_score": -17.244440569143876}
{"event": "best", "epoch": 7, "val_f1": 0.39497794036611744, "val_miss": 0.053658536584493356, "val_fpr": 0.17600321834438698, "selection_score": -17.244440569143876, "best_metric_score": -17.244440569143876, "gen_f1": 0.5873631659172399, "gen_miss": 0.09112349914217169, "gen_fpr": 0.22020941991471107, "threshold": 0.7626003980636596, "avg_reg_loss": 68.41366754011675}
{"event": "epoch", "epoch": 8, "train_loss": 0.4033436693928458, "val_loss": 1.2044439287117021, "val_f1": 0.3798297282807201, "val_miss": 0.05691056910476568, "val_fpr": 0.18696570451555167, "avg_reg_loss": 67.01292081890684, "gen_f1": 0.6079430402089857, "gen_miss": 0.06625214408219071, "gen_fpr": 0.2113309710553763, "threshold": 0.7426430225372315, "selection_score": -17.783065699751706, "best_metric_score": -17.783065699751706}
{"event": "epoch", "epoch": 9, "train_loss": 0.4026871607159123, "val_loss": 1.2364353984791936, "val_f1": 0.4514819288518981, "val_miss": 0.09593495934803357, "val_fpr": 0.12994066177197028, "avg_reg_loss": 77.89887175126509, "gen_f1": 0.6562281947468942, "gen_miss": 0.09240994854182588, "gen_fpr": 0.15941394274787618, "threshold": 0.76755490899086, "selection_score": -20.942415433299274, "best_metric_score": -20.942415433299274}
{"event": "epoch", "epoch": 10, "train_loss": 0.40176914487824295, "val_loss": 1.213456130949108, "val_f1": 0.4553571391075087, "val_miss": 0.08780487804735276, "val_fpr": 0.12953836870146881, "avg_reg_loss": 89.3187884012858, "gen_f1": 0.6675968946071371, "gen_miss": 0.07675814751269992, "gen_fpr": 0.15646773101876957, "threshold": 0.7594306766986847, "selection_score": -21.2551073051844, "best_metric_score": -21.2551073051844}
{"event": "epoch", "epoch": 11, "train_loss": 0.39786328266967425, "val_loss": 1.2225458989384546, "val_f1": 0.34965034670661876, "val_miss": 0.024390243902042436, "val_fpr": 0.22297093432543197, "avg_reg_loss": 84.91586810025302, "gen_f1": 0.5448259088377193, "gen_miss": 0.037092624356695775, "gen_fpr": 0.29187402954162844, "threshold": 0.74, "selection_score": -17.462779814184408, "best_metric_score": -17.462779814184408}
{"event": "epoch", "epoch": 12, "train_loss": 0.39745164332967814, "val_loss": 1.2662438375747977, "val_f1": 0.46382802431494097, "val_miss": 0.08780487804735276, "val_fpr": 0.12501257165832744, "avg_reg_loss": 80.00607822302617, "gen_f1": 0.6663576624422445, "gen_miss": 0.07525728987977004, "gen_fpr": 0.15798065055533783, "threshold": 0.7768345773220062, "selection_score": -20.175680308226887, "best_metric_score": -20.175680308226887}
{"event": "epoch", "epoch": 13, "train_loss": 0.3969121010014505, "val_loss": 1.2697119592016992, "val_f1": 0.45730705697707286, "val_miss": 0.09430894308789742, "val_fpr": 0.1271246102784601, "avg_reg_loss": 84.66828456069484, "gen_f1": 0.6675433122183653, "gen_miss": 0.07482847341321863, "gen_fpr": 0.15722419078705369, "threshold": 0.7777017652988434, "selection_score": -21.364014790550677, "best_metric_score": -21.364014790550677}
{"event": "epoch", "epoch": 14, "train_loss": 0.39536289699149857, "val_loss": 1.2359222725589836, "val_f1": 0.4551724100444866, "val_miss": 0.08780487804735276, "val_fpr": 0.1296389419690942, "avg_reg_loss": 88.51845222241951, "gen_f1": 0.6657880409671074, "gen_miss": 0.0793310463120083, "gen_fpr": 0.15690568141093406, "threshold": 0.7656553685665131, "selection_score": -21.178362529559106, "best_metric_score": -21.178362529559106}
{"event": "epoch", "epoch": 15, "train_loss": 0.39508850032633, "val_loss": 1.2667669607035295, "val_f1": 0.454767722401558, "val_miss": 0.09268292682776125, "val_fpr": 0.12883435582809127, "avg_reg_loss": 89.90048377297141, "gen_f1": 0.6649109171499612, "gen_miss": 0.07975986277855969, "gen_fpr": 0.15742325914712846, "threshold": 0.7780441641807556, "selection_score": -21.779942344711564, "best_metric_score": -21.779942344711564}
{"event": "epoch", "epoch": 16, "train_loss": 0.3943511085076766, "val_loss": 1.2619237858003955, "val_f1": 0.45919208194926286, "val_miss": 0.09430894308789742, "val_fpr": 0.12611887760220644, "avg_reg_loss": 91.65827072605943, "gen_f1": 0.6659452728654388, "gen_miss": 0.07632933104614853, "gen_fpr": 0.15790102321130792, "threshold": 0.7756163775920868, "selection_score": -22.030087250131807, "best_metric_score": -22.030087250131807}
{"event": "epoch", "epoch": 17, "train_loss": 0.3936439588214412, "val_loss": 1.2472466814357643, "val_f1": 0.4639004111325804, "val_miss": 0.09105691056762509, "val_fpr": 0.1243085587849499, "avg_reg_loss": 96.39066095063181, "gen_f1": 0.6665122695917479, "gen_miss": 0.07439965694666724, "gen_fpr": 0.1581797189154126, "threshold": 0.7695781886577606, "selection_score": -22.117540653808845, "best_metric_score": -22.117540653808845}
{"event": "epoch", "epoch": 18, "train_loss": 0.39225112624240643, "val_loss": 1.280248808802066, "val_f1": 0.45894909310185417, "val_miss": 0.09105691056762509, "val_fpr": 0.12692346374320937, "avg_reg_loss": 103.82690267851858, "gen_f1": 0.6666150943965845, "gen_miss": 0.07611492281287283, "gen_fpr": 0.15746307281914343, "threshold": 0.7802620828151703, "selection_score": -22.94682308778441, "best_metric_score": -22.94682308778441}
{"event": "epoch", "epoch": 19, "train_loss": 0.39137581713271863, "val_loss": 1.2808331721748993, "val_f1": 0.4616652888742219, "val_miss": 0.08943089430748893, "val_fpr": 0.12581715779933036, "avg_reg_loss": 103.1419614387281, "gen_f1": 0.6668727732518959, "gen_miss": 0.07504288164649434, "gen_fpr": 0.1576621411792182, "threshold": 0.7802301347255707, "selection_score": -22.678865896837927, "best_metric_score": -22.678865896837927}
{"event": "epoch", "epoch": 20, "train_loss": 0.3909837896173651, "val_loss": 1.2843491599107697, "val_f1": 0.4986449824330144, "val_miss": 0.10243902438857823, "val_fpr": 0.1053002112037561, "avg_reg_loss": 92.83188911206794, "gen_f1": 0.6945531590166747, "gen_miss": 0.08683533447665773, "gen_fpr": 0.1330174782019616, "threshold": 0.788, "selection_score": -22.278452886266052, "best_metric_score": -22.278452886266052}
{"event": "epoch", "epoch": 21, "train_loss": 0.3905050847566489, "val_loss": 1.2511751955037407, "val_f1": 0.37734627512637914, "val_miss": 0.05203252032435719, "val_fpr": 0.19028462234718868, "avg_reg_loss": 89.63280013113311, "gen_f1": 0.5247731134036719, "gen_miss": 0.08254716981114377, "gen_fpr": 0.29322769439013685, "threshold": 0.752159708738327, "selection_score": -19.662167941632177, "best_metric_score": -19.662167941632177}
{"event": "epoch", "epoch": 22, "train_loss": 0.39033127246481, "val_loss": 1.2679568496837064, "val_f1": 0.4712351907320002, "val_miss": 0.09430894308789742, "val_fpr": 0.11988333500943388, "avg_reg_loss": 88.55893732706706, "gen_f1": 0.6619999953979042, "gen_miss": 0.07740137221252702, "gen_fpr": 0.16056853923630984, "threshold": 0.7763708531856537, "selection_score": -21.51565578315438, "best_metric_score": -21.51565578315438}
{"event": "epoch", "epoch": 23, "train_loss": 0.3908623443408446, "val_loss": 1.2826334487129554, "val_f1": 0.5076001801815694, "val_miss": 0.10406504064871439, "val_fpr": 0.10107613396349081, "avg_reg_loss": 86.91932620424213, "gen_f1": 0.6988031318709622, "gen_miss": 0.09240994854182588, "gen_fpr": 0.12812039654412224, "threshold": 0.788, "selection_score": -21.710470269419353, "best_metric_score": -21.710470269419353}
{"event": "epoch", "epoch": 24, "train_loss": 0.3904309484091672, "val_loss": 1.2887264054298944, "val_f1": 0.49706810604515206, "val_miss": 0.10406504064871439, "val_fpr": 0.10570250427425756, "avg_reg_loss": 87.83312655362217, "gen_f1": 0.687915648174432, "gen_miss": 0.0906946826756203, "gen_fpr": 0.13636182665121774, "threshold": 0.788, "selection_score": -21.955171585616206, "best_metric_score": -21.955171585616206}
{"event": "epoch", "epoch": 25, "train_loss": 0.38856411169875754, "val_loss": 1.2661561880357384, "val_f1": 0.4784853661554987, "val_miss": 0.09593495934803357, "val_fpr": 0.11596097757204468, "avg_reg_loss": 86.21781856652463, "gen_f1": 0.6559815904961823, "gen_miss": 0.08297598627769516, "gen_fpr": 0.1631962415892968, "threshold": 0.7756769955158234, "selection_score": -21.315834942956023, "best_metric_score": -21.315834942956023}
{"event": "epoch", "epoch": 26, "train_loss": 0.38943514787789546, "val_loss": 1.263007166169317, "val_f1": 0.3756799968362005, "val_miss": 0.045528455283812545, "val_fpr": 0.19340239364357495, "avg_reg_loss": 86.72305633082534, "gen_f1": 0.5289743706412079, "gen_miss": 0.07718696397925132, "gen_fpr": 0.29083887406923964, "threshold": 0.7560601472854614, "selection_score": -18.81868084498484, "best_metric_score": -18.81868084498484}
{"event": "epoch", "epoch": 27, "train_loss": 0.3895905065717119, "val_loss": 1.266733309224059, "val_f1": 0.4270755387136749, "val_miss": 0.07154471544599114, "val_fpr": 0.14965302222654162, "avg_reg_loss": 87.0737469066273, "gen_f1": 0.5723804947501355, "gen_miss": 0.09755574614044264, "gen_fpr": 0.23227296253524216, "threshold": 0.7649667620658874, "selection_score": -20.05369113563896, "best_metric_score": -20.05369113563896}
{"event": "epoch", "epoch": 28, "train_loss": 0.3907444835612268, "val_loss": 1.2924417589938784, "val_f1": 0.4695874057457148, "val_miss": 0.10243902438857823, "val_fpr": 0.11907874886843096, "avg_reg_loss": 87.02123059359464, "gen_f1": 0.6516560316713693, "gen_miss": 0.090909090908896, "gen_fpr": 0.16359437830944634, "threshold": 0.7818373739719391, "selection_score": -22.151708119274993, "best_metric_score": -22.151708119274993}
{"event": "epoch", "epoch": 29, "train_loss": 0.38894978156595517, "val_loss": 1.2717434039823168, "val_f1": 0.42596045897538337, "val_miss": 0.07154471544599114, "val_fpr": 0.15035703509991916, "avg_reg_loss": 87.06015830762459, "gen_f1": 0.5737414922655989, "gen_miss": 0.09584048027423706, "gen_fpr": 0.23167575745501784, "threshold": 0.7667151808738708, "selection_score": -20.075176147865175, "best_metric_score": -20.075176147865175}
{"event": "epoch", "epoch": 30, "train_loss": 0.3903733298634038, "val_loss": 1.263666534383181, "val_f1": 0.42857142501324275, "val_miss": 0.0731707317061273, "val_fpr": 0.1483455697474119, "avg_reg_loss": 87.37670227975556, "gen_f1": 0.5740099134747692, "gen_miss": 0.09412521440803147, "gen_fpr": 0.23219333519121224, "threshold": 0.7648074746131897, "selection_score": -20.204738941087754, "best_metric_score": -20.204738941087754}
{"event": "epoch", "epoch": 31, "train_loss": 0.3898199742490595, "val_loss": 1.3106030202494536, "val_f1": 0.46007446868866564, "val_miss": 0.09593495934803357, "val_fpr": 0.12531429146120354, "avg_reg_loss": 87.26240574229847, "gen_f1": 0.6667181540364296, "gen_miss": 0.07461406517994294, "gen_fpr": 0.15794083688332286, "threshold": 0.7880046367645264, "selection_score": -21.727387085443414, "best_metric_score": -21.727387085443414}
{"event": "epoch", "epoch": 32, "train_loss": 0.38867496956478464, "val_loss": 1.3131899550277686, "val_f1": 0.46511627526250066, "val_miss": 0.08943089430748893, "val_fpr": 0.1240068389820738, "avg_reg_loss": 86.89506068374172, "gen_f1": 0.6705773340758132, "gen_miss": 0.0686106346482234, "gen_fpr": 0.15718437711503874, "threshold": 0.7882714867591858, "selection_score": -20.99485079738136, "best_metric_score": -20.99485079738136}
{"event": "final", "best_threshold": 0.7882714867591858, "gen_threshold": 0.78, "gen_threshold_source": "auto_sweep", "val_loss": 1.3131899550277686, "val_f1": 0.46511627526250066, "val_miss": 0.08943089430748893, "val_fpr": 0.1240068389820738, "val_auc": 0.9588388775369197, "gen_loss": 1.1823945922898957, "gen_f1": 0.6271246666416478, "gen_miss": 0.05467409948530302, "gen_fpr": 0.19859059601059098, "gen_auc": 0.9490375480145714, "weight_dist_score_weight": 0.1, "gen_threshold_options": {"low_miss": {"threshold": 0.7798, "metrics": {"sensitivity": 0.94596912521238, "specificity": 0.8003742485166221, "precision": 0.4680670485885125, "f1": 0.6262597542643397, "miss_rate": 0.05403087478547592, "fpr": 0.19962575148297979, "tp": 4412, "tn": 20103, "fp": 5014, "fn": 252}}, "balanced": {"threshold": 0.803, "metrics": {"sensitivity": 0.9000857632913807, "specificity": 0.8918262531349715, "precision": 0.6070860448292016, "f1": 0.7251057901613708, "miss_rate": 0.09991423670647531, "fpr": 0.10817374686463026, "tp": 4198, "tn": 22400, "fp": 2717, "fn": 466}}, "low_fpr": {"threshold": 0.803, "metrics": {"sensitivity": 0.9000857632913807, "specificity": 0.8918262531349715, "precision": 0.6070860448292016, "f1": 0.7251057901613708, "miss_rate": 0.09991423670647531, "fpr": 0.10817374686463026, "tp": 4198, "tn": 22400, "fp": 2717, "fn": 466}}}, "gen_threshold_sweep": {"sweep_csv": "artifacts\\gen_threshold_sweep_hardware_reg_1e-04.csv", "low_miss_candidate_count": 2203, "low_miss_top10": [{"threshold": 0.7798, "miss_rate": 0.05403087478547592, "fpr": 0.19962575148297979, "roc": 0.7463433737294002}, {"threshold": 0.7799, "miss_rate": 0.05424528301875162, "fpr": 0.19898873273074053, "roc": 0.7467659842483638}, {"threshold": 0.78, "miss_rate": 0.05467409948530302, "fpr": 0.19859059601059098, "roc": 0.746735304501962}, {"threshold": 0.7801, "miss_rate": 0.05488850771857871, "fpr": 0.19791376358633678, "roc": 0.7471977286929405}, {"threshold": 0.7802, "miss_rate": 0.05531732418513011, "fpr": 0.19759525421021715, "roc": 0.7470874216025086}, {"threshold": 0.7803, "miss_rate": 0.05553173241840581, "fpr": 0.19699804912999283, "roc": 0.7474702184494573}, {"threshold": 0.7804, "miss_rate": 0.05574614065168151, "fpr": 0.19652028506581337, "roc": 0.747733574280361}, {"threshold": 0.7806, "miss_rate": 0.055960548884957204, "fpr": 0.19540550224939465, "roc": 0.7486339488635041}, {"threshold": 0.7805, "miss_rate": 0.055960548884957204, "fpr": 0.1957240116255143, "roc": 0.7483154394873844}, {"threshold": 0.7807, "miss_rate": 0.056389365351508604, "fpr": 0.19504717920126008, "roc": 0.7485634554450873}], "low_fpr_candidate_count": 8031, "low_fpr_top10": [{"threshold": 0.803, "miss_rate": 0.09991423670647531, "fpr": 0.10817374686463026, "roc": 0.7919120164267505}, {"threshold": 0.8029, "miss_rate": 0.09991423670647531, "fpr": 0.10821356053664521, "roc": 0.7918722027547355}, {"threshold": 0.8028, "miss_rate": 0.09991423670647531, "fpr": 0.10825337420866017, "roc": 0.7918323890827205}, {"threshold": 0.8027, "miss_rate": 0.09991423670647531, "fpr": 0.1085718835847798, "roc": 0.7915138797066009}, {"threshold": 0.8026, "miss_rate": 0.09969982847319962, "fpr": 0.10881076561686952, "roc": 0.7914894059077868}, {"threshold": 0.8025, "miss_rate": 0.09969982847319962, "fpr": 0.10897002030492933, "roc": 0.791330151219727}, {"threshold": 0.8024, "miss_rate": 0.09969982847319962, "fpr": 0.1090894613209742, "roc": 0.7912107102036822}, {"threshold": 0.8023, "miss_rate": 0.09969982847319962, "fpr": 0.10924871600903402, "roc": 0.7910514555156223}, {"threshold": 0.8022, "miss_rate": 0.09969982847319962, "fpr": 0.10944778436910879, "roc": 0.7908523871555475}, {"threshold": 0.8021, "miss_rate": 0.09969982847319962, "fpr": 0.10972648007321346, "roc": 0.7905736914514429}], "balanced": {"threshold": 0.803, "miss_rate": 0.09991423670647531, "fpr": 0.10817374686463026, "roc": 0.7919120164267505}}}

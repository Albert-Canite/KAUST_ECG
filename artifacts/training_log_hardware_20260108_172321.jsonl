{"event": "start", "timestamp": "2026-01-08T17:23:33.441120", "config": {"data_path": "E:/OneDrive - KAUST/ONN codes/MIT-BIH/mit-bih-arrhythmia-database-1.0.0/", "batch_size": 128, "lr": 0.001, "weight_decay": 0.0001, "max_epochs": 90, "patience": 25, "min_epochs": 25, "scheduler_patience": 3, "dropout_rate": 0.2, "num_mlp_layers": 0, "constraint_scale": 1.0, "class_weight_abnormal": 1.35, "class_weight_max_ratio": 2.0, "generalization_score_weight": 0.35, "threshold_target_miss": 0.1, "threshold_max_fpr": 0.1, "threshold_recall_gain": 2.0, "threshold_miss_penalty": 1.25, "threshold_gen_recall_gain": 2.5, "threshold_gen_miss_penalty": 1.35, "gen_threshold": null, "gen_threshold_target_miss": null, "gen_threshold_max_fpr": null, "gen_threshold_tighten_factor": 0.7, "gen_threshold_fpr_relax_factor": 1.25, "seed": 42, "input_bits": 5, "weight_bits": 5, "snr_min": 10.0, "snr_max": 30.0, "pbr_min": 0.5, "pbr_max": 0.9, "pbr_peak_window": 12, "pbr_min_prominence": 0.05, "weight_target": 1.0, "weight_target_strength": 0.0001, "use_bias": false, "use_constrained_classifier": true, "hardware_prob": 1.0, "hardware_eval": true, "use_value_constraint": true, "use_tanh_activations": false}, "class_counts": [39707, 2525], "class_weights": [2.9553844928741455, 11.289742469787598], "data_range": [-1.0, 1.0]}
{"event": "epoch", "epoch": 1, "train_loss": 0.6488113683281522, "val_loss": 0.7456813367349358, "val_f1": 0.19605878239134195, "val_miss": 0.045528455283812545, "val_fpr": 0.4813436588549921, "gen_f1": 0.42238322434956715, "gen_miss": 0.11878216123473674, "gen_fpr": 0.42548871282381434, "threshold": 0.5252509713172913}
{"event": "best", "epoch": 1, "val_f1": 0.19605878239134195, "val_miss": 0.045528455283812545, "val_fpr": 0.4813436588549921, "gen_f1": 0.42238322434956715, "gen_miss": 0.11878216123473674, "gen_fpr": 0.42548871282381434, "threshold": 0.5252509713172913}
{"event": "epoch", "epoch": 2, "train_loss": 0.5546411840301572, "val_loss": 0.8429377103398347, "val_f1": 0.20061622543492563, "val_miss": 0.04715447154394871, "val_fpr": 0.4667605350493143, "gen_f1": 0.4304585060896772, "gen_miss": 0.09519725557440996, "gen_fpr": 0.4269220050163527, "threshold": 0.5682832598686218}
{"event": "best", "epoch": 2, "val_f1": 0.20061622543492563, "val_miss": 0.04715447154394871, "val_fpr": 0.4667605350493143, "gen_f1": 0.4304585060896772, "gen_miss": 0.09519725557440996, "gen_fpr": 0.4269220050163527, "threshold": 0.5682832598686218}
{"event": "epoch", "epoch": 3, "train_loss": 0.4630423181887829, "val_loss": 0.9576112808411625, "val_f1": 0.2103195838325935, "val_miss": 0.04227642276354022, "val_fpr": 0.4422206577487255, "gen_f1": 0.44800483316356937, "gen_miss": 0.046740994854102186, "gen_fpr": 0.427519210096577, "threshold": 0.6148574352264404}
{"event": "best", "epoch": 3, "val_f1": 0.2103195838325935, "val_miss": 0.04227642276354022, "val_fpr": 0.4422206577487255, "gen_f1": 0.44800483316356937, "gen_miss": 0.046740994854102186, "gen_fpr": 0.427519210096577, "threshold": 0.6148574352264404}
{"event": "epoch", "epoch": 4, "train_loss": 0.4276115857290499, "val_loss": 1.0265447835756039, "val_f1": 0.20463988729320476, "val_miss": 0.0390243902432679, "val_fpr": 0.45961983304791343, "gen_f1": 0.45209169566540053, "gen_miss": 0.04652658662082649, "gen_fpr": 0.4205120038219451, "threshold": 0.6368864178657532}
{"event": "epoch", "epoch": 5, "train_loss": 0.4140353918978662, "val_loss": 1.0607859378828426, "val_f1": 0.22948870178250463, "val_miss": 0.05853658536490184, "val_fpr": 0.3874082268929021, "gen_f1": 0.46459262103628657, "gen_miss": 0.08426243567734935, "gen_fpr": 0.3762790142133311, "threshold": 0.6624698638916016}
{"event": "best", "epoch": 5, "val_f1": 0.22948870178250463, "val_miss": 0.05853658536490184, "val_fpr": 0.3874082268929021, "gen_f1": 0.46459262103628657, "gen_miss": 0.08426243567734935, "gen_fpr": 0.3762790142133311, "threshold": 0.6624698638916016}
{"event": "epoch", "epoch": 6, "train_loss": 0.4088957063176415, "val_loss": 1.069995264411763, "val_f1": 0.2122035106039095, "val_miss": 0.04715447154394871, "val_fpr": 0.4346776626768232, "gen_f1": 0.447154467958684, "gen_miss": 0.0448113207546209, "gen_fpr": 0.4302663534656088, "threshold": 0.6547847390174866}
{"event": "epoch", "epoch": 7, "train_loss": 0.4073193719892791, "val_loss": 1.0985685509699585, "val_f1": 0.2289866435940664, "val_miss": 0.05203252032435719, "val_fpr": 0.3916323041331674, "gen_f1": 0.46586695367679876, "gen_miss": 0.08404802744407365, "gen_fpr": 0.37440777162862826, "threshold": 0.6733640789985657}
{"event": "epoch", "epoch": 8, "train_loss": 0.4058769191756393, "val_loss": 1.1302858038051582, "val_f1": 0.23066270804981726, "val_miss": 0.05203252032435719, "val_fpr": 0.3879110932310289, "gen_f1": 0.4585079137174118, "gen_miss": 0.09669811320733984, "gen_fpr": 0.3782298841420638, "threshold": 0.6844174981117248}
{"event": "best", "epoch": 8, "val_f1": 0.23066270804981726, "val_miss": 0.05203252032435719, "val_fpr": 0.3879110932310289, "gen_f1": 0.4585079137174118, "gen_miss": 0.09669811320733984, "gen_fpr": 0.3782298841420638, "threshold": 0.6844174981117248}
{"event": "epoch", "epoch": 9, "train_loss": 0.40019911148331383, "val_loss": 1.1553482565380313, "val_f1": 0.2143771701260981, "val_miss": 0.04715447154394871, "val_fpr": 0.4290455596898028, "gen_f1": 0.4355920292505145, "gen_miss": 0.06689536878201781, "gen_fpr": 0.43659672731598653, "threshold": 0.6831875443458557}
{"event": "epoch", "epoch": 10, "train_loss": 0.39841771974708096, "val_loss": 1.1833946617247142, "val_f1": 0.2168807319419531, "val_miss": 0.0390243902432679, "val_fpr": 0.4268329478020448, "gen_f1": 0.44184711345743866, "gen_miss": 0.09219554030855018, "gen_fpr": 0.40876697057753364, "threshold": 0.6920000000000001}
{"event": "epoch", "epoch": 11, "train_loss": 0.3981494341835831, "val_loss": 1.1949633347037436, "val_f1": 0.20719929570221718, "val_miss": 0.040650406503404055, "val_fpr": 0.4515739716378843, "gen_f1": 0.43879720202161654, "gen_miss": 0.07075471698098038, "gen_fpr": 0.42823585619284615, "threshold": 0.6899746060371399}
{"event": "epoch", "epoch": 12, "train_loss": 0.3964428143970894, "val_loss": 1.1977653460060924, "val_f1": 0.21105527441733143, "val_miss": 0.04390243902367638, "val_fpr": 0.43940460625521527, "gen_f1": 0.43698746936654254, "gen_miss": 0.06882504288149909, "gen_fpr": 0.4327746148025509, "threshold": 0.6939997076988219}
{"event": "epoch", "epoch": 13, "train_loss": 0.3953033086025354, "val_loss": 1.214310370062445, "val_f1": 0.2076038884232562, "val_miss": 0.045528455283812545, "val_fpr": 0.44785276073574587, "gen_f1": 0.4339698862630395, "gen_miss": 0.07911663807873259, "gen_fpr": 0.43138113628202757, "threshold": 0.6957647800445557}
{"event": "epoch", "epoch": 14, "train_loss": 0.3958286184253115, "val_loss": 1.2183237562894957, "val_f1": 0.1919011203327959, "val_miss": 0.040650406503404055, "val_fpr": 0.4972342351397996, "gen_f1": 0.4195909142016106, "gen_miss": 0.04116638078893404, "gen_fpr": 0.4849305251421408, "threshold": 0.6865817308425903}
{"event": "epoch", "epoch": 15, "train_loss": 0.39672589654272256, "val_loss": 1.227753180268814, "val_f1": 0.20437956013391786, "val_miss": 0.04390243902367638, "val_fpr": 0.45770894096303155, "gen_f1": 0.43452652596095837, "gen_miss": 0.08254716981114377, "gen_fpr": 0.4280766015047864, "threshold": 0.6961334347724915}
{"event": "epoch", "epoch": 16, "train_loss": 0.39670125860156435, "val_loss": 1.232507738386914, "val_f1": 0.20195439550708152, "val_miss": 0.04227642276354022, "val_fpr": 0.46555365583780994, "gen_f1": 0.43597063259023294, "gen_miss": 0.08319039451097086, "gen_fpr": 0.42505076243164985, "threshold": 0.6971511244773865}
{"event": "epoch", "epoch": 17, "train_loss": 0.39542488979570795, "val_loss": 1.2306932949346898, "val_f1": 0.2055749109780045, "val_miss": 0.040650406503404055, "val_fpr": 0.4560997686810257, "gen_f1": 0.43249276618729643, "gen_miss": 0.08619210977683063, "gen_fpr": 0.42931082533724996, "threshold": 0.6993900537490845}
{"event": "epoch", "epoch": 18, "train_loss": 0.3955610714175484, "val_loss": 1.2297751912792472, "val_f1": 0.1977618154266799, "val_miss": 0.037398373983131734, "val_fpr": 0.4807402192492399, "gen_f1": 0.4263531681617523, "gen_miss": 0.06689536878201781, "gen_fpr": 0.45383604729846166, "threshold": 0.6920000000000001}
{"event": "epoch", "epoch": 19, "train_loss": 0.39635786278681323, "val_loss": 1.2218413380064461, "val_f1": 0.2066666647408723, "val_miss": 0.04227642276354022, "val_fpr": 0.45217741124363653, "gen_f1": 0.4312117033136231, "gen_miss": 0.08704974270993343, "gen_fpr": 0.4310626269059079, "threshold": 0.6981784105300903}
{"event": "epoch", "epoch": 20, "train_loss": 0.39598344067732494, "val_loss": 1.217501729495328, "val_f1": 0.2073018680397238, "val_miss": 0.053658536584493356, "val_fpr": 0.44433269636885814, "gen_f1": 0.43369970397530927, "gen_miss": 0.07783018867907841, "gen_fpr": 0.432734801130536, "threshold": 0.6970084309577942}
{"event": "epoch", "epoch": 21, "train_loss": 0.3949847220471411, "val_loss": 1.2212988675419727, "val_f1": 0.19942635211275345, "val_miss": 0.0390243902432679, "val_fpr": 0.4748063964593434, "gen_f1": 0.4248654379967641, "gen_miss": 0.060677530017022564, "gen_fpr": 0.4609626945891384, "threshold": 0.6920000000000001}
{"event": "epoch", "epoch": 22, "train_loss": 0.3969546312635595, "val_loss": 1.2164572581442767, "val_f1": 0.2096659539871873, "val_miss": 0.040650406503404055, "val_fpr": 0.44483556270698493, "gen_f1": 0.43085615905659286, "gen_miss": 0.08447684391062506, "gen_fpr": 0.4334514472268052, "threshold": 0.6975085735321045}
{"event": "epoch", "epoch": 23, "train_loss": 0.39708660958391245, "val_loss": 1.2320306845338174, "val_f1": 0.196645073734001, "val_miss": 0.037398373983131734, "val_fpr": 0.48415971034850225, "gen_f1": 0.42670437569138764, "gen_miss": 0.06196397941667675, "gen_fpr": 0.45654337699547853, "threshold": 0.6920000000000001}
{"event": "epoch", "epoch": 24, "train_loss": 0.39630705930969934, "val_loss": 1.2527664214016971, "val_f1": 0.20030711294772974, "val_miss": 0.045528455283812545, "val_fpr": 0.4685708538665708, "gen_f1": 0.43342862614466826, "gen_miss": 0.08983704974251751, "gen_fpr": 0.4251702034476947, "threshold": 0.7007505893707275}
{"event": "epoch", "epoch": 25, "train_loss": 0.39569369455178577, "val_loss": 1.230494563813055, "val_f1": 0.20497650757128114, "val_miss": 0.04227642276354022, "val_fpr": 0.4569043548220286, "gen_f1": 0.43386457866172173, "gen_miss": 0.08361921097752226, "gen_fpr": 0.4285543655689658, "threshold": 0.6982571482658386}
{"event": "epoch", "epoch": 26, "train_loss": 0.39502127161531736, "val_loss": 1.211614001178904, "val_f1": 0.21394841792037525, "val_miss": 0.04227642276354022, "val_fpr": 0.4326661973243159, "gen_f1": 0.43203128559025367, "gen_miss": 0.07632933104614853, "gen_fpr": 0.4367957956760613, "threshold": 0.6985911726951599}
{"event": "epoch", "epoch": 27, "train_loss": 0.3960012639110739, "val_loss": 1.2412927583393487, "val_f1": 0.19178082011248776, "val_miss": 0.04390243902367638, "val_fpr": 0.49572563612541914, "gen_f1": 0.4129081646816941, "gen_miss": 0.07547169811304573, "gen_fpr": 0.4741808336981032, "threshold": 0.6920000000000001}
{"event": "epoch", "epoch": 28, "train_loss": 0.396038991483775, "val_loss": 1.2440266776522986, "val_f1": 0.20199244056943597, "val_miss": 0.04390243902367638, "val_fpr": 0.4645479231615563, "gen_f1": 0.42900086253007175, "gen_miss": 0.09734133790716694, "gen_fpr": 0.4281164151768013, "threshold": 0.7006261348724365}
{"event": "epoch", "epoch": 29, "train_loss": 0.3956758919990424, "val_loss": 1.2291707433654313, "val_f1": 0.18863708728111345, "val_miss": 0.0390243902432679, "val_fpr": 0.5089007341843418, "gen_f1": 0.41134015412209735, "gen_miss": 0.06518010291581222, "gen_fpr": 0.48473145678206603, "threshold": 0.6862706005573272}
{"event": "epoch", "epoch": 30, "train_loss": 0.39588498825376683, "val_loss": 1.230305793543254, "val_f1": 0.19514611011143845, "val_miss": 0.0390243902432679, "val_fpr": 0.48788092125064075, "gen_f1": 0.4222501901517049, "gen_miss": 0.06496569468253652, "gen_fpr": 0.463072819205931, "threshold": 0.6920000000000001}
{"event": "epoch", "epoch": 31, "train_loss": 0.3955928882866195, "val_loss": 1.2364666759120986, "val_f1": 0.18644067622150318, "val_miss": 0.03414634146285941, "val_fpr": 0.5192597807497543, "gen_f1": 0.4158725609129752, "gen_miss": 0.059605488850644074, "gen_fpr": 0.47947605207609206, "threshold": 0.6855375230312347}
{"event": "epoch", "epoch": 32, "train_loss": 0.39685229713266545, "val_loss": 1.2476690833734323, "val_f1": 0.19138292543437857, "val_miss": 0.03577235772299557, "val_fpr": 0.501760032182941, "gen_f1": 0.41734939410497834, "gen_miss": 0.07161234991408316, "gen_fpr": 0.46804952820780027, "threshold": 0.6920000000000001}
{"event": "epoch", "epoch": 33, "train_loss": 0.395608892585292, "val_loss": 1.2297579657965976, "val_f1": 0.1963455131150556, "val_miss": 0.0390243902432679, "val_fpr": 0.48415971034850225, "gen_f1": 0.4215767599682425, "gen_miss": 0.07418524871339155, "gen_fpr": 0.4579766691880169, "threshold": 0.6920000000000001}
{"event": "final", "best_threshold": 0.6920000000000001, "gen_threshold": 0.6677438020706177, "gen_threshold_source": "auto_sweep", "val_loss": 1.2258330787711804, "val_f1": 0.1966442934505501, "val_miss": 0.04715447154394871, "val_fpr": 0.4786281806291072, "gen_loss": 1.1447351755326856, "gen_f1": 0.3765714730173709, "gen_miss": 0.030231560891873434, "gen_fpr": 0.5906358243418439, "gen_threshold_options": {"low_miss": {"threshold": 0.8044, "metrics": {"sensitivity": 0.4554030874775828, "specificity": 0.8000955528125173, "precision": 0.2972708187539576, "f1": 0.35972562821187415, "miss_rate": 0.5445969125202732, "fpr": 0.19990444718708447, "tp": 2124, "tn": 20096, "fp": 5021, "fn": 2540}}, "balanced": {"threshold": 0.7015, "metrics": {"sensitivity": 0.9033018867905162, "specificity": 0.5798463192257913, "precision": 0.285317621562857, "f1": 0.43365928610923143, "miss_rate": 0.09669811320733984, "fpr": 0.4201536807738105, "tp": 4213, "tn": 14564, "fp": 10553, "fn": 451}}, "low_fpr": {"threshold": 0.7022, "metrics": {"sensitivity": 0.900514579757932, "specificity": 0.5823943942347484, "precision": 0.28592824562578395, "f1": 0.43404123025843266, "miss_rate": 0.09948542023992392, "fpr": 0.41760560576485345, "tp": 4200, "tn": 14628, "fp": 10489, "fn": 464}}}, "gen_threshold_sweep": {"sweep_csv": "artifacts\\gen_threshold_sweep_hardware.csv", "low_miss_candidate_count": 1957, "low_miss_top10": [{"threshold": 0.8044, "miss_rate": 0.5445969125202732, "fpr": 0.19990444718708447, "roc": 0.2554986402904983}, {"threshold": 0.8046, "miss_rate": 0.5450257289868246, "fpr": 0.1991878010908153, "roc": 0.2557864699202161}, {"threshold": 0.8045, "miss_rate": 0.5450257289868246, "fpr": 0.19962575148297979, "roc": 0.2553485195280516}, {"threshold": 0.8048, "miss_rate": 0.545454545453376, "fpr": 0.19898873273074053, "roc": 0.25555672181373945}, {"threshold": 0.8047, "miss_rate": 0.545454545453376, "fpr": 0.19914798741880035, "roc": 0.2553974671256796}, {"threshold": 0.805, "miss_rate": 0.546097770153203, "fpr": 0.19859059601059098, "roc": 0.2553116338340619}, {"threshold": 0.8049, "miss_rate": 0.546097770153203, "fpr": 0.19882947804268072, "roc": 0.2550727518019722}, {"threshold": 0.8051, "miss_rate": 0.5467409948530302, "fpr": 0.19843134132253118, "roc": 0.2548276638222946}, {"threshold": 0.8053, "miss_rate": 0.5469554030863059, "fpr": 0.1981526456184265, "roc": 0.2548919512931236}, {"threshold": 0.8052, "miss_rate": 0.5469554030863059, "fpr": 0.19831190030648632, "roc": 0.25473269660506376}], "low_fpr_candidate_count": 7023, "low_fpr_top10": [{"threshold": 0.7022, "miss_rate": 0.09948542023992392, "fpr": 0.41760560576485345, "roc": 0.4829089739930786}, {"threshold": 0.7021, "miss_rate": 0.09884219554009682, "fpr": 0.41804355615701794, "roc": 0.48311424830074123}, {"threshold": 0.702, "miss_rate": 0.09841337907354543, "fpr": 0.41852132022119737, "roc": 0.48306530070311315}, {"threshold": 0.7019, "miss_rate": 0.09819897084026973, "fpr": 0.41872038858127214, "roc": 0.48308064057631406}, {"threshold": 0.7018, "miss_rate": 0.09798456260699404, "fpr": 0.4190388979573918, "roc": 0.4829765394334701}, {"threshold": 0.7017, "miss_rate": 0.09755574614044264, "fpr": 0.41931759366149646, "roc": 0.4831266601959169}, {"threshold": 0.7016, "miss_rate": 0.09734133790716694, "fpr": 0.4196361030376161, "roc": 0.4830225590530729}, {"threshold": 0.7015, "miss_rate": 0.09669811320733984, "fpr": 0.4201536807738105, "roc": 0.48314820601670566}, {"threshold": 0.7014, "miss_rate": 0.09648370497406414, "fpr": 0.420591631165975, "roc": 0.48292466385781685}, {"threshold": 0.7013, "miss_rate": 0.09605488850751275, "fpr": 0.42091014054209464, "roc": 0.48303497094824854}], "balanced": {"threshold": 0.7015, "miss_rate": 0.09669811320733984, "fpr": 0.4201536807738105, "roc": 0.48314820601670566}}}

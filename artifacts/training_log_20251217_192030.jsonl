{"event": "start", "timestamp": "2025-12-17T19:20:35.729972", "config": {"data_path": "E:/OneDrive - KAUST/ONN codes/MIT-BIH/mit-bih-arrhythmia-database-1.0.0/", "batch_size": 128, "lr": 0.001, "weight_decay": 0.0001, "max_epochs": 90, "patience": 25, "min_epochs": 25, "scheduler_patience": 3, "dropout_rate": 0.2, "num_mlp_layers": 3, "constraint_scale": 1.0, "class_weight_abnormal": 1.35, "class_weight_max_ratio": 2.0, "generalization_score_weight": 0.35, "threshold_target_miss": 0.1, "threshold_max_fpr": 0.1, "threshold_recall_gain": 2.0, "threshold_miss_penalty": 1.25, "threshold_gen_recall_gain": 2.5, "threshold_gen_miss_penalty": 1.35, "use_fn_penalty_4cls": false, "use_weighted_sampler": false, "sampler_power": 0.5, "sampler_abnormal_boost": 1.0, "use_fn_penalty": true, "seed": 42, "use_value_constraint": true, "use_tanh_activations": false}, "class_counts": [47677, 1973, 2238, 7200], "class_weights": [0.5, 1.5004682540893555, 1.4088356494903564, 0.7854600548744202], "data_range": [-1.0, 1.0]}
{"event": "epoch", "epoch": 1, "train_loss": 1.0530231798563487, "val_loss": 0.6802515044545123, "val_f1": 0.49312768433583326, "val_miss": 0.19795221842935853, "val_fpr": 0.358946212952496, "val_macro_f1": 0.22247896002404569, "gen_f1": 0.5293881486355396, "gen_miss": 0.17364840673080265, "gen_fpr": 0.2348302939839591, "gen_macro_f1": 0.22922555115884682, "threshold": 0.2731356620788574}
{"event": "best", "epoch": 1, "val_f1": 0.49312768433583326, "val_miss": 0.19795221842935853, "val_fpr": 0.358946212952496, "val_macro_f1": 0.22247896002404569, "gen_f1": 0.5293881486355396, "gen_miss": 0.17364840673080265, "gen_fpr": 0.2348302939839591, "gen_macro_f1": 0.22922555115884682, "threshold": 0.2731356620788574}
{"event": "epoch", "epoch": 2, "train_loss": 0.908926308606977, "val_loss": 0.6004424496485563, "val_f1": 0.5699025189364795, "val_miss": 0.2716723549478783, "val_fpr": 0.20476230684775412, "val_macro_f1": 0.22247896002404569, "gen_f1": 0.5326252778100321, "gen_miss": 0.21894020766162023, "gen_fpr": 0.2087740930624282, "gen_macro_f1": 0.22922555115884682, "threshold": 0.19478704035282135}
{"event": "epoch", "epoch": 3, "train_loss": 0.8616182520852449, "val_loss": 0.5707922912697846, "val_f1": 0.5877203042468429, "val_miss": 0.129351535835736, "val_fpr": 0.270201806974356, "val_macro_f1": 0.22951975473010194, "gen_f1": 0.5088151245446175, "gen_miss": 0.07518796992467743, "gen_fpr": 0.310013628398887, "gen_macro_f1": 0.23086214219590043, "threshold": 0.1367016166448593}
{"event": "best", "epoch": 3, "val_f1": 0.5877203042468429, "val_miss": 0.129351535835736, "val_fpr": 0.270201806974356, "val_macro_f1": 0.22951975473010194, "gen_f1": 0.5088151245446175, "gen_miss": 0.07518796992467743, "gen_fpr": 0.310013628398887, "gen_macro_f1": 0.23086214219590043, "threshold": 0.1367016166448593}
{"event": "epoch", "epoch": 4, "train_loss": 0.8535534698176184, "val_loss": 0.5623007627941781, "val_f1": 0.6325254057546703, "val_miss": 0.17167235494821956, "val_fpr": 0.19564299586236963, "val_macro_f1": 0.34439462617077266, "gen_f1": 0.5166897686651483, "gen_miss": 0.13265306122425233, "gen_fpr": 0.2700694399376111, "gen_macro_f1": 0.27646393042041595, "threshold": 0.131360924243927}
{"event": "best", "epoch": 4, "val_f1": 0.6325254057546703, "val_miss": 0.17167235494821956, "val_fpr": 0.19564299586236963, "val_macro_f1": 0.34439462617077266, "gen_f1": 0.5166897686651483, "gen_miss": 0.13265306122425233, "gen_fpr": 0.2700694399376111, "gen_macro_f1": 0.27646393042041595, "threshold": 0.131360924243927}
{"event": "epoch", "epoch": 5, "train_loss": 0.8525259272857891, "val_loss": 0.5636864903574669, "val_f1": 0.6134707166327283, "val_miss": 0.16689419795164884, "val_fpr": 0.2184412733258309, "val_macro_f1": 0.33649339302855774, "gen_f1": 0.5301570071498424, "gen_miss": 0.12352309344768435, "gen_fpr": 0.259199169316549, "gen_macro_f1": 0.240561832264297, "threshold": 0.13920822143554687}
{"event": "epoch", "epoch": 6, "train_loss": 0.8470406605885534, "val_loss": 0.5657125031755231, "val_f1": 0.5017486071848113, "val_miss": 0.1675767918083018, "val_fpr": 0.3675588955498036, "val_macro_f1": 0.34173577258152793, "gen_f1": 0.4723240431115305, "gen_miss": 0.07733619763681107, "gen_fpr": 0.35965993899657356, "gen_macro_f1": 0.2847735437601445, "threshold": 0.15339874625205993}
{"event": "epoch", "epoch": 7, "train_loss": 0.8528102025280727, "val_loss": 0.5758961314904232, "val_f1": 0.5748418788356014, "val_miss": 0.16245733788340458, "val_fpr": 0.2663176559990996, "val_macro_f1": 0.345028633365602, "gen_f1": 0.5471212925183162, "gen_miss": 0.12388113139970662, "gen_fpr": 0.24044389642408967, "gen_macro_f1": 0.26997241350003, "threshold": 0.188691845536232}
{"event": "best", "epoch": 7, "val_f1": 0.5748418788356014, "val_miss": 0.16245733788340458, "val_fpr": 0.2663176559990996, "val_macro_f1": 0.345028633365602, "gen_f1": 0.5471212925183162, "gen_miss": 0.12388113139970662, "gen_fpr": 0.24044389642408967, "gen_macro_f1": 0.26997241350003, "threshold": 0.188691845536232}
{"event": "epoch", "epoch": 8, "train_loss": 0.8478614440817772, "val_loss": 0.5705623186523054, "val_f1": 0.5758556846950225, "val_miss": 0.1501706484636513, "val_fpr": 0.2725660727853816, "val_macro_f1": 0.3485509266296443, "gen_f1": 0.4904862539433357, "gen_miss": 0.10705334765465976, "gen_fpr": 0.3168602764617052, "gen_macro_f1": 0.2760528373096546, "threshold": 0.19102446436882017}
{"event": "best", "epoch": 8, "val_f1": 0.5758556846950225, "val_miss": 0.1501706484636513, "val_fpr": 0.2725660727853816, "val_macro_f1": 0.3485509266296443, "gen_f1": 0.4904862539433357, "gen_miss": 0.10705334765465976, "gen_fpr": 0.3168602764617052, "gen_macro_f1": 0.2760528373096546, "threshold": 0.19102446436882017}
{"event": "epoch", "epoch": 9, "train_loss": 0.8457088619753045, "val_loss": 0.5680164366240331, "val_f1": 0.5644046630610816, "val_miss": 0.1498293515353248, "val_fpr": 0.28759604829833013, "val_macro_f1": 0.34868701817238235, "gen_f1": 0.490178567421922, "gen_miss": 0.1154672395271832, "gen_fpr": 0.3125770653513166, "gen_macro_f1": 0.27082206801377, "threshold": 0.17832340598106383}
{"event": "best", "epoch": 9, "val_f1": 0.5644046630610816, "val_miss": 0.1498293515353248, "val_fpr": 0.28759604829833013, "val_macro_f1": 0.34868701817238235, "gen_f1": 0.490178567421922, "gen_miss": 0.1154672395271832, "gen_fpr": 0.3125770653513166, "gen_macro_f1": 0.27082206801377, "threshold": 0.17832340598106383}
{"event": "epoch", "epoch": 10, "train_loss": 0.8432470111546077, "val_loss": 0.5537785501516577, "val_f1": 0.550795093566256, "val_miss": 0.07201365187688732, "val_fpr": 0.3566663852061499, "val_macro_f1": 0.3455158828402679, "gen_f1": 0.4644488495854487, "gen_miss": 0.09899749373415861, "gen_fpr": 0.35868648192603064, "gen_macro_f1": 0.2679419857671555, "threshold": 0.13138101994991302}
{"event": "epoch", "epoch": 11, "train_loss": 0.8425178364334861, "val_loss": 0.5536029027236675, "val_f1": 0.6443402497505044, "val_miss": 0.17918088737140211, "val_fpr": 0.1798530777673057, "val_macro_f1": 0.3455868003188354, "gen_f1": 0.5948549089436568, "gen_miss": 0.12656641603987367, "gen_fpr": 0.19271205139847078, "gen_macro_f1": 0.26789060222307337, "threshold": 0.15244241058826438}
{"event": "epoch", "epoch": 12, "train_loss": 0.8371966959433991, "val_loss": 0.5489666609009448, "val_f1": 0.5768767079676365, "val_miss": 0.1017064846412911, "val_fpr": 0.3008528244530095, "val_macro_f1": 0.34631729484165996, "gen_f1": 0.5025677132056261, "gen_miss": 0.10651629072662636, "gen_fpr": 0.30128496333301924, "gen_macro_f1": 0.2660672133401494, "threshold": 0.13421789407730103}
{"event": "epoch", "epoch": 13, "train_loss": 0.8404933524557868, "val_loss": 0.5528560579569509, "val_f1": 0.5837193867556804, "val_miss": 0.09692832764472038, "val_fpr": 0.29468884573140697, "val_macro_f1": 0.34742653159531034, "gen_f1": 0.5093117775009766, "gen_miss": 0.09183673469371315, "gen_fpr": 0.30053864624560306, "gen_macro_f1": 0.2674854999848721, "threshold": 0.15147001445293426}
{"event": "epoch", "epoch": 14, "train_loss": 0.8373732177700546, "val_loss": 0.5510723339731011, "val_f1": 0.6115476552717372, "val_miss": 0.08361774743998765, "val_fpr": 0.26733091277525345, "val_macro_f1": 0.3472979656686511, "gen_f1": 0.5081658873183765, "gen_miss": 0.0809165771570338, "gen_fpr": 0.3078071257056565, "gen_macro_f1": 0.26618819259702275, "threshold": 0.13758472502231597}
{"event": "epoch", "epoch": 15, "train_loss": 0.8404245921147085, "val_loss": 0.5488007821630368, "val_f1": 0.674212849821178, "val_miss": 0.1156996587026768, "val_fpr": 0.18280841003108772, "val_macro_f1": 0.34610832788077917, "gen_f1": 0.5185060522244678, "gen_miss": 0.1723952738987247, "gen_fpr": 0.24735544162494408, "gen_macro_f1": 0.26726332713544515, "threshold": 0.164}
{"event": "epoch", "epoch": 16, "train_loss": 0.8312717520735499, "val_loss": 0.5425361634664511, "val_f1": 0.6155088808216619, "val_miss": 0.0897610921498643, "val_fpr": 0.2591404205013433, "val_macro_f1": 0.34316777061562054, "gen_f1": 0.4947591121982481, "gen_miss": 0.10007160759022543, "gen_fpr": 0.3150107080276737, "gen_macro_f1": 0.26686208333903405, "threshold": 0.14188170731067656}
{"event": "epoch", "epoch": 17, "train_loss": 0.8259650213977299, "val_loss": 0.5420286863656968, "val_f1": 0.6072719016232627, "val_miss": 0.08225255972668173, "val_fpr": 0.27332601536749696, "val_macro_f1": 0.34060076612035506, "gen_f1": 0.4958521642874386, "gen_miss": 0.10651629072662636, "gen_fpr": 0.310013628398887, "gen_macro_f1": 0.2513336227041475, "threshold": 0.13801282644271848}
{"event": "epoch", "epoch": 18, "train_loss": 0.8228063376783324, "val_loss": 0.5307634830321535, "val_f1": 0.6049830080218287, "val_miss": 0.08839590443655838, "val_fpr": 0.2726505108500611, "val_macro_f1": 0.2555633295937529, "gen_f1": 0.47573975419967846, "gen_miss": 0.10920157536679341, "gen_fpr": 0.3360698293204179, "gen_macro_f1": 0.24097875743958289, "threshold": 0.116}
{"event": "epoch", "epoch": 19, "train_loss": 0.820620351776404, "val_loss": 0.5266295207633732, "val_f1": 0.6902320513425613, "val_miss": 0.12696245733745065, "val_fpr": 0.16245883644333153, "val_macro_f1": 0.28324385309679423, "gen_f1": 0.5220920749423519, "gen_miss": 0.19405656999607224, "gen_fpr": 0.23226685703152952, "gen_macro_f1": 0.2661054031708988, "threshold": 0.164}
{"event": "epoch", "epoch": 20, "train_loss": 0.8197106857497357, "val_loss": 0.5237009608050799, "val_f1": 0.6701731832473741, "val_miss": 0.10853242320782071, "val_fpr": 0.1902389597228825, "val_macro_f1": 0.254639409808433, "gen_f1": 0.5023345635035996, "gen_miss": 0.16219119226608988, "gen_fpr": 0.27149717697440734, "gen_macro_f1": 0.239200107302807, "threshold": 0.15008096098899842}
{"event": "epoch", "epoch": 21, "train_loss": 0.8182982879862565, "val_loss": 0.5195764020737947, "val_f1": 0.6674373748801067, "val_miss": 0.11331058020439144, "val_fpr": 0.19057671198160045, "val_macro_f1": 0.29945753950800835, "gen_f1": 0.4902644382205035, "gen_miss": 0.18188327962731493, "gen_fpr": 0.27539100525657884, "gen_macro_f1": 0.2830173266346369, "threshold": 0.12980482876300814}
{"event": "epoch", "epoch": 22, "train_loss": 0.8156957809369221, "val_loss": 0.523854777907854, "val_f1": 0.6766839331123238, "val_miss": 0.10853242320782071, "val_fpr": 0.18390610487192102, "val_macro_f1": 0.2969324249003276, "gen_f1": 0.4959375626271343, "gen_miss": 0.1695309702825465, "gen_fpr": 0.27526121098050643, "gen_macro_f1": 0.2799968421054025, "threshold": 0.12783668041229249}
{"event": "epoch", "epoch": 23, "train_loss": 0.8144300980455599, "val_loss": 0.5062544778295016, "val_f1": 0.6818841488376834, "val_miss": 0.11808873720096216, "val_fpr": 0.1743646035631391, "val_macro_f1": 0.2550808358117898, "gen_f1": 0.5089925153259393, "gen_miss": 0.14124597207278689, "gen_fpr": 0.2747095853071988, "gen_macro_f1": 0.24206613915918881, "threshold": 0.13715367913246157}
{"event": "epoch", "epoch": 24, "train_loss": 0.7993423257163311, "val_loss": 0.49743685045408864, "val_f1": 0.6613166097700695, "val_miss": 0.09999999999965871, "val_fpr": 0.20332685974820286, "val_macro_f1": 0.34202608408501106, "gen_f1": 0.5034773404188736, "gen_miss": 0.1446473326169985, "gen_fpr": 0.27957687065991316, "gen_macro_f1": 0.26830446777386113, "threshold": 0.116}
{"event": "epoch", "epoch": 25, "train_loss": 0.7971748296981448, "val_loss": 0.4964391583435458, "val_f1": 0.6652095607433174, "val_miss": 0.11706484641598272, "val_fpr": 0.19091446424031838, "val_macro_f1": 0.3483487040051264, "gen_f1": 0.5102412826665889, "gen_miss": 0.14822771213722122, "gen_fpr": 0.2695178142643035, "gen_macro_f1": 0.2702539368208337, "threshold": 0.10609994679689408}
{"event": "epoch", "epoch": 26, "train_loss": 0.7950193826790073, "val_loss": 0.49973382505931246, "val_f1": 0.6721395540546968, "val_miss": 0.10580204778120887, "val_fpr": 0.1896478932701261, "val_macro_f1": 0.33928011954781434, "gen_f1": 0.5157793002234918, "gen_miss": 0.1398138202646978, "gen_fpr": 0.26740865727812724, "gen_macro_f1": 0.2544739257845224, "threshold": 0.10964008271694184}
{"event": "epoch", "epoch": 27, "train_loss": 0.7917002972599745, "val_loss": 0.496152207353205, "val_f1": 0.6407650880947935, "val_miss": 0.08532423208162006, "val_fpr": 0.23262686819198458, "val_macro_f1": 0.34363458274495556, "gen_f1": 0.5062287614740694, "gen_miss": 0.11976369495145048, "gen_fpr": 0.28953858134846855, "gen_macro_f1": 0.25781445370265, "threshold": 0.116}
{"event": "epoch", "epoch": 28, "train_loss": 0.7888515750437999, "val_loss": 0.487420293889904, "val_f1": 0.6622383710872907, "val_miss": 0.0982935153580263, "val_fpr": 0.20324242168352338, "val_macro_f1": 0.347104183000637, "gen_f1": 0.49162010759951275, "gen_miss": 0.15717866093777805, "gen_fpr": 0.2874618729313104, "gen_macro_f1": 0.26700924189007297, "threshold": 0.116}
{"event": "epoch", "epoch": 29, "train_loss": 0.7883364641017588, "val_loss": 0.4916892647985307, "val_f1": 0.6601282488338847, "val_miss": 0.10409556313957646, "val_fpr": 0.202482479101408, "val_macro_f1": 0.34589088054019596, "gen_f1": 0.5240595356995166, "gen_miss": 0.13336913712829687, "gen_fpr": 0.2611460834576348, "gen_macro_f1": 0.27335189571144625, "threshold": 0.08969767987728122}
{"event": "epoch", "epoch": 30, "train_loss": 0.7887215815906179, "val_loss": 0.49329870592270436, "val_f1": 0.6708957070756331, "val_miss": 0.09761092150137335, "val_fpr": 0.19488305328025424, "val_macro_f1": 0.34434334016849116, "gen_f1": 0.49432323135675216, "gen_miss": 0.15431435732159987, "gen_fpr": 0.28564475306629705, "gen_macro_f1": 0.25822151067558463, "threshold": 0.116}
{"event": "epoch", "epoch": 31, "train_loss": 0.7832433979523528, "val_loss": 0.4885082820181129, "val_f1": 0.6824262844119612, "val_miss": 0.10341296928292351, "val_fpr": 0.18086633454345952, "val_macro_f1": 0.34584423300485706, "gen_f1": 0.5147098041321293, "gen_miss": 0.13712853562453076, "gen_fpr": 0.2700694399376111, "gen_macro_f1": 0.2617294983373359, "threshold": 0.12617270350456242}
{"event": "epoch", "epoch": 32, "train_loss": 0.7799491242538646, "val_loss": 0.48583474997167525, "val_f1": 0.6741716724256377, "val_miss": 0.10068259385631166, "val_fpr": 0.190154521658203, "val_macro_f1": 0.3456382608542446, "gen_f1": 0.5109881211005314, "gen_miss": 0.14876476906525463, "gen_fpr": 0.268349665779652, "gen_macro_f1": 0.2606755999355428, "threshold": 0.11093991398811341}
{"event": "epoch", "epoch": 33, "train_loss": 0.7842114868281561, "val_loss": 0.4916912412333568, "val_f1": 0.6743107399519254, "val_miss": 0.10682593856618831, "val_fpr": 0.18703031326506203, "val_macro_f1": 0.3475952594201148, "gen_f1": 0.5101253574254369, "gen_miss": 0.1476906552091878, "gen_fpr": 0.2699396456615387, "gen_macro_f1": 0.27093825467163724, "threshold": 0.08313303887844085}
{"event": "epoch", "epoch": 34, "train_loss": 0.7810030678181735, "val_loss": 0.4867948083800743, "val_f1": 0.6963043726715535, "val_miss": 0.12866894197908305, "val_fpr": 0.15621041965704954, "val_macro_f1": 0.34716526350444465, "gen_f1": 0.5600383625490498, "gen_miss": 0.1638023630501901, "gen_fpr": 0.20844960737224724, "gen_macro_f1": 0.27237524229737625, "threshold": 0.116}
{"event": "final", "best_threshold": 0.116, "val_loss": 0.4867948083800743, "val_f1": 0.6963043726715535, "val_miss": 0.12866894197908305, "val_fpr": 0.15621041965704954, "gen_loss": 0.47665577285002386, "gen_f1": 0.5600383625490498, "gen_miss": 0.1638023630501901, "gen_fpr": 0.20844960737224724, "val_macro_f1": 0.34716526350444465, "gen_macro_f1": 0.27237524229737625}

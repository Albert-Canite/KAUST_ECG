{"event": "start", "timestamp": "2025-12-11T22:38:20.424060", "config": {"data_path": "E:/OneDrive - KAUST/ONN codes/MIT-BIH/mit-bih-arrhythmia-database-1.0.0/", "batch_size": 128, "lr": 0.001, "weight_decay": 0.0001, "max_epochs": 90, "patience": 25, "min_epochs": 25, "scheduler_patience": 3, "dropout_rate": 0.2, "num_mlp_layers": 3, "constraint_scale": 1.0, "class_weight_abnormal": 1.35, "class_weight_max_ratio": 2.0, "generalization_score_weight": 0.35, "threshold_target_miss": 0.1, "threshold_max_fpr": 0.1, "threshold_recall_gain": 2.0, "threshold_miss_penalty": 1.25, "threshold_gen_recall_gain": 2.5, "threshold_gen_miss_penalty": 1.35, "seed": 42, "use_value_constraint": true, "use_tanh_activations": false, "use_kd": true, "kd_start_epoch": 5, "kd_alpha": 0.1, "kd_temperature": 2.0, "ema_decay": 0.99}, "class_counts": [39707, 2525], "class_weights": [2.9553844928741455, 11.289742469787598], "data_range": [-1.0, 1.0]}
{"event": "epoch", "epoch": 1, "train_loss": 0.60168638084874, "train_ce_loss": 0.60168638084874, "train_kd_loss": 0.0, "val_loss": 1.294425994005364, "val_f1": 0.25287356090554675, "val_miss": 0.05203252032435719, "val_fpr": 0.3432565624053673, "gen_f1": 0.5268983535229471, "gen_miss": 0.05081475128634045, "gen_fpr": 0.30708285225134085, "threshold": 0.7474007368087768}
{"event": "best", "epoch": 1, "val_f1": 0.25287356090554675, "val_miss": 0.05203252032435719, "val_fpr": 0.3432565624053673, "gen_f1": 0.5268983535229471, "gen_miss": 0.05081475128634045, "gen_fpr": 0.30708285225134085, "threshold": 0.7474007368087768}
{"event": "epoch", "epoch": 2, "train_loss": 0.46147830377925525, "train_ce_loss": 0.46147830377925525, "train_kd_loss": 0.0, "val_loss": 1.379726219276606, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02}
{"event": "epoch", "epoch": 3, "train_loss": 0.4893426860823776, "train_ce_loss": 0.4893426860823776, "train_kd_loss": 0.0, "val_loss": 1.5531909175613745, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02}
{"event": "epoch", "epoch": 4, "train_loss": 0.49213873301491595, "train_ce_loss": 0.49213873301491595, "train_kd_loss": 0.0, "val_loss": 1.5465396278214785, "val_f1": 0.11008681539200146, "val_miss": 0.0, "val_fpr": 0.9999999999989941, "gen_f1": 0.27080853300464786, "gen_miss": 0.0, "gen_fpr": 0.9999999999996019, "threshold": 0.02}
{"event": "epoch", "epoch": 5, "train_loss": 0.3860947685711312, "train_ce_loss": 0.4175037936730818, "train_kd_loss": 0.10341364118750349, "val_loss": 1.141591542867757, "val_f1": 0.23503936794967997, "val_miss": 0.02926829268245092, "val_fpr": 0.3890173991749079, "gen_f1": 0.5011987756329703, "gen_miss": 0.013936535162920377, "gen_fpr": 0.3618664649439177, "threshold": 0.6575974762439728}
{"event": "epoch", "epoch": 6, "train_loss": 0.3157930996381875, "train_ce_loss": 0.3455707177068248, "train_kd_loss": 0.04779461828258001, "val_loss": 1.0831017211025966, "val_f1": 0.3150305018833759, "val_miss": 0.07642276422639963, "val_fpr": 0.24368902745625695, "gen_f1": 0.6243194147579432, "gen_miss": 0.0780445969123541, "gen_fpr": 0.19154357606394412, "threshold": 0.6175873398780822}
{"event": "best", "epoch": 6, "val_f1": 0.3150305018833759, "val_miss": 0.07642276422639963, "val_fpr": 0.24368902745625695, "gen_f1": 0.6243194147579432, "gen_miss": 0.0780445969123541, "gen_fpr": 0.19154357606394412, "threshold": 0.6175873398780822}
{"event": "epoch", "epoch": 7, "train_loss": 0.2963528108867732, "train_ce_loss": 0.32237212188316117, "train_kd_loss": 0.0621790911212112, "val_loss": 1.0410885480480407, "val_f1": 0.27517257545706725, "val_miss": 0.060162601625038004, "val_fpr": 0.3025243890170949, "gen_f1": 0.5882739971926114, "gen_miss": 0.04159519725548543, "gen_fpr": 0.24139029342666662, "threshold": 0.563720417022705}
{"event": "epoch", "epoch": 8, "train_loss": 0.286044501219735, "train_ce_loss": 0.30989849842859035, "train_kd_loss": 0.07135860684017341, "val_loss": 0.9756376855773984, "val_f1": 0.30972259351766956, "val_miss": 0.06504065040544649, "val_fpr": 0.2537463542187934, "gen_f1": 0.6397424596530294, "gen_miss": 0.06260720411650385, "gen_fpr": 0.18441692877326735, "threshold": 0.5433022260665894}
{"event": "epoch", "epoch": 9, "train_loss": 0.2760332448916002, "train_ce_loss": 0.29800114812272965, "train_kd_loss": 0.07832218196355935, "val_loss": 0.9032251899001679, "val_f1": 0.30897815846139637, "val_miss": 0.06829268292571881, "val_fpr": 0.2535452076835426, "gen_f1": 0.652282031782332, "gen_miss": 0.04395368782151811, "gen_fpr": 0.18111239399602613, "threshold": 0.500229787826538}
{"event": "epoch", "epoch": 10, "train_loss": 0.2687270562757145, "train_ce_loss": 0.2887616364793344, "train_kd_loss": 0.08841590654443611, "val_loss": 0.8998499991180635, "val_f1": 0.3029666552060633, "val_miss": 0.06178861788517417, "val_fpr": 0.26320024137557757, "gen_f1": 0.640141463215646, "gen_miss": 0.0686106346482234, "gen_fpr": 0.18170959907625045, "threshold": 0.47805664539337156}
{"event": "epoch", "epoch": 11, "train_loss": 0.2667834559173295, "train_ce_loss": 0.28567724823951723, "train_kd_loss": 0.09673939384520054, "val_loss": 0.8517351720138444, "val_f1": 0.44630738152129124, "val_miss": 0.09105691056762509, "val_fpr": 0.13386301920935947, "gen_f1": 0.6991329963874847, "gen_miss": 0.18739279588296015, "gen_fpr": 0.09507504877171036, "threshold": 0.5154271125793455}
{"event": "best", "epoch": 11, "val_f1": 0.44630738152129124, "val_miss": 0.09105691056762509, "val_fpr": 0.13386301920935947, "gen_f1": 0.6991329963874847, "gen_miss": 0.18739279588296015, "gen_fpr": 0.09507504877171036, "threshold": 0.5154271125793455}
{"event": "epoch", "epoch": 12, "train_loss": 0.26178732198296173, "train_ce_loss": 0.2793453005678726, "train_kd_loss": 0.1037655675614422, "val_loss": 0.8152195431558804, "val_f1": 0.45919208194926286, "val_miss": 0.09430894308789742, "val_fpr": 0.12611887760220644, "gen_f1": 0.7378317451093951, "gen_miss": 0.1923241852483012, "gen_fpr": 0.07086833618661828, "threshold": 0.548}
{"event": "best", "epoch": 12, "val_f1": 0.45919208194926286, "val_miss": 0.09430894308789742, "val_fpr": 0.12611887760220644, "gen_f1": 0.7378317451093951, "gen_miss": 0.1923241852483012, "gen_fpr": 0.07086833618661828, "threshold": 0.548}
{"event": "epoch", "epoch": 13, "train_loss": 0.2568757619370114, "train_ce_loss": 0.2730013624285207, "train_kd_loss": 0.11174542241250024, "val_loss": 0.7941850000065506, "val_f1": 0.4755784022842721, "val_miss": 0.09756097560816974, "val_fpr": 0.11706728351592369, "gen_f1": 0.7515628100998648, "gen_miss": 0.20090051457932911, "gen_fpr": 0.060795477166834894, "threshold": 0.548}
{"event": "best", "epoch": 13, "val_f1": 0.4755784022842721, "val_miss": 0.09756097560816974, "val_fpr": 0.11706728351592369, "gen_f1": 0.7515628100998648, "gen_miss": 0.20090051457932911, "gen_fpr": 0.060795477166834894, "threshold": 0.548}
{"event": "epoch", "epoch": 14, "train_loss": 0.2537394789132205, "train_ce_loss": 0.2692641975753235, "train_kd_loss": 0.11401707532279419, "val_loss": 0.786290499416123, "val_f1": 0.31220031691763633, "val_miss": 0.04715447154394871, "val_fpr": 0.25676355224755426, "gen_f1": 0.694043532525075, "gen_miss": 0.06689536878201781, "gen_fpr": 0.14034319385271316, "threshold": 0.404}
{"event": "epoch", "epoch": 15, "train_loss": 0.25075843496756123, "train_ce_loss": 0.2652326668302218, "train_kd_loss": 0.12049041482986826, "val_loss": 0.8310118410641055, "val_f1": 0.3028277608325308, "val_miss": 0.04227642276354022, "val_fpr": 0.2701397968417277, "gen_f1": 0.6947787916608922, "gen_miss": 0.06560891938236361, "gen_fpr": 0.14026356650868324, "threshold": 0.404}
{"event": "epoch", "epoch": 16, "train_loss": 0.25049317519773134, "train_ce_loss": 0.2637526954213778, "train_kd_loss": 0.13115755135588575, "val_loss": 0.6851087103266679, "val_f1": 0.35878564551134984, "val_miss": 0.04878048780408487, "val_fpr": 0.2072815045758752, "gen_f1": 0.7186647891144275, "gen_miss": 0.0675385934818449, "gen_fpr": 0.12302424652620814, "threshold": 0.37283338606357574}
{"event": "epoch", "epoch": 17, "train_loss": 0.25190031334306257, "train_ce_loss": 0.26488339815175893, "train_kd_loss": 0.13505261066285046, "val_loss": 0.7516025518982626, "val_f1": 0.5370819153446467, "val_miss": 0.0991869918683059, "val_fpr": 0.08991250125707541, "gen_f1": 0.7832286850060518, "gen_miss": 0.21097770154328693, "gen_fpr": 0.041923796631746654, "threshold": 0.74}
{"event": "best", "epoch": 17, "val_f1": 0.5370819153446467, "val_miss": 0.0991869918683059, "val_fpr": 0.08991250125707541, "gen_f1": 0.7832286850060518, "gen_miss": 0.21097770154328693, "gen_fpr": 0.041923796631746654, "threshold": 0.74}
{"event": "epoch", "epoch": 18, "train_loss": 0.24823333155928237, "train_ce_loss": 0.2608672086488117, "train_kd_loss": 0.13452849661310515, "val_loss": 0.7773880478468193, "val_f1": 0.5359223259035772, "val_miss": 0.10243902438857823, "val_fpr": 0.08981192798945005, "gen_f1": 0.7903897440640603, "gen_miss": 0.20647512864449727, "gen_fpr": 0.03981367201495409, "threshold": 0.788}
{"event": "epoch", "epoch": 19, "train_loss": 0.24788801805539565, "train_ce_loss": 0.25981289929512774, "train_kd_loss": 0.14056414826349778, "val_loss": 0.63671753424703, "val_f1": 0.3482380781560679, "val_miss": 0.04390243902367638, "val_fpr": 0.2186462838175413, "gen_f1": 0.7336523078338725, "gen_miss": 0.06303602058305524, "gen_fpr": 0.11462356173105281, "threshold": 0.35600000000000004}
{"event": "epoch", "epoch": 20, "train_loss": 0.2464759496125308, "train_ce_loss": 0.25772453126582234, "train_kd_loss": 0.14523877049937392, "val_loss": 0.6633150104569494, "val_f1": 0.43824091418125033, "val_miss": 0.06829268292571881, "val_fpr": 0.1435180529013944, "gen_f1": 0.7828922798399855, "gen_miss": 0.09927101200664822, "gen_fpr": 0.07433212565191928, "threshold": 0.3888815641403198}
{"event": "epoch", "epoch": 21, "train_loss": 0.24321251159364526, "train_ce_loss": 0.25440768161506366, "train_kd_loss": 0.14245605145891507, "val_loss": 0.6882103130907289, "val_f1": 0.41999999647898767, "val_miss": 0.0780487804865358, "val_fpr": 0.15267022025530255, "gen_f1": 0.7936507887260399, "gen_miss": 0.09412521440803147, "gen_fpr": 0.06999243540228929, "threshold": 0.4174717843532562}
{"event": "epoch", "epoch": 22, "train_loss": 0.24306982015118456, "train_ce_loss": 0.2538373666730794, "train_kd_loss": 0.1461619581688534, "val_loss": 0.7045251207158384, "val_f1": 0.4859732373565225, "val_miss": 0.08455284552708044, "val_fpr": 0.11455295182528959, "gen_f1": 0.8293875904191305, "gen_miss": 0.09112349914217169, "gen_fpr": 0.05251423338772444, "threshold": 0.5}
{"event": "epoch", "epoch": 23, "train_loss": 0.24356206172343456, "train_ce_loss": 0.25439697973655934, "train_kd_loss": 0.14604785830685588, "val_loss": 0.7207440999923138, "val_f1": 0.4243992571120148, "val_miss": 0.06666666666558266, "val_fpr": 0.1524690737200518, "gen_f1": 0.7837135918247744, "gen_miss": 0.09412521440803147, "gen_fpr": 0.07536728112430809, "threshold": 0.452}
{"event": "epoch", "epoch": 24, "train_loss": 0.23926782459020615, "train_ce_loss": 0.25031801082871175, "train_kd_loss": 0.1398162086804708, "val_loss": 0.7197157115754722, "val_f1": 0.4967148449423869, "val_miss": 0.0780487804865358, "val_fpr": 0.11073116765552575, "gen_f1": 0.8084938998696397, "gen_miss": 0.11835334476818535, "gen_fpr": 0.05557988613287591, "threshold": 0.548}
{"event": "epoch", "epoch": 25, "train_loss": 0.24085195940552337, "train_ce_loss": 0.25159365214181667, "train_kd_loss": 0.14417678569302414, "val_loss": 0.766716735553597, "val_f1": 0.48040454735698657, "val_miss": 0.0731707317061273, "val_fpr": 0.11948104193893243, "gen_f1": 0.8003482248778649, "gen_miss": 0.1129931389362929, "gen_fpr": 0.06119361388698443, "threshold": 0.5960000000000001}
{"event": "epoch", "epoch": 26, "train_loss": 0.2378096162369757, "train_ce_loss": 0.24864709056688078, "train_kd_loss": 0.14027240269563415, "val_loss": 0.6844816174577596, "val_f1": 0.486394553956833, "val_miss": 0.06991869918585499, "val_fpr": 0.11716785678354905, "gen_f1": 0.811468283492792, "gen_miss": 0.09884219554009682, "gen_fpr": 0.0594019986463115, "threshold": 0.452}
{"event": "epoch", "epoch": 27, "train_loss": 0.2401680928288084, "train_ce_loss": 0.2509601692358653, "train_kd_loss": 0.14303946404746085, "val_loss": 0.6661293563076799, "val_f1": 0.484076429257928, "val_miss": 0.0731707317061273, "val_fpr": 0.11767072312167587, "gen_f1": 0.8122946016580889, "gen_miss": 0.09905660377337253, "gen_fpr": 0.05892423458213205, "threshold": 0.452}
{"event": "epoch", "epoch": 28, "train_loss": 0.23678283303072958, "train_ce_loss": 0.24789359257979826, "train_kd_loss": 0.13678605883862033, "val_loss": 0.6909408503171282, "val_f1": 0.48495124667102857, "val_miss": 0.06991869918585499, "val_fpr": 0.1178718696569266, "gen_f1": 0.8129987451718308, "gen_miss": 0.09348198970820437, "gen_fpr": 0.06007883107056572, "threshold": 0.452}
{"event": "epoch", "epoch": 29, "train_loss": 0.23683988641608844, "train_ce_loss": 0.2477974846959114, "train_kd_loss": 0.1382215585672494, "val_loss": 0.7065720643074048, "val_f1": 0.48267117112743657, "val_miss": 0.07154471544599114, "val_fpr": 0.11867645579792951, "gen_f1": 0.8108728893897482, "gen_miss": 0.09176672384199878, "gen_fpr": 0.061631564279148926, "threshold": 0.5}
{"event": "epoch", "epoch": 30, "train_loss": 0.23642696783398137, "train_ce_loss": 0.247608006271449, "train_kd_loss": 0.13579768495577754, "val_loss": 0.710068691395566, "val_f1": 0.49076063211901033, "val_miss": 0.07154471544599114, "val_fpr": 0.11475409836054032, "gen_f1": 0.8160372729772074, "gen_miss": 0.09884219554009682, "gen_fpr": 0.05709280566944416, "threshold": 0.5}
{"event": "epoch", "epoch": 31, "train_loss": 0.23355329835956748, "train_ce_loss": 0.24421531539974792, "train_kd_loss": 0.13759520839561115, "val_loss": 0.6748554854992326, "val_f1": 0.49122806629311844, "val_miss": 0.06666666666558266, "val_fpr": 0.11545811123391786, "gen_f1": 0.80158041328218, "gen_miss": 0.10827615780422754, "gen_fpr": 0.061870446311238655, "threshold": 0.452}
{"event": "epoch", "epoch": 32, "train_loss": 0.23508096955942384, "train_ce_loss": 0.24574336964975704, "train_kd_loss": 0.13911942582238804, "val_loss": 0.7160795631000413, "val_f1": 0.5082922416317643, "val_miss": 0.0780487804865358, "val_fpr": 0.10550135773900683, "gen_f1": 0.8258102368845519, "gen_miss": 0.09584048027423706, "gen_fpr": 0.053031811123918846, "threshold": 0.5960000000000001}
{"event": "epoch", "epoch": 33, "train_loss": 0.23501263730453723, "train_ce_loss": 0.24547659677989556, "train_kd_loss": 0.14083705120014423, "val_loss": 0.7184803411011715, "val_f1": 0.48179508505205193, "val_miss": 0.07479674796626347, "val_fpr": 0.11847530926267878, "gen_f1": 0.816866069922951, "gen_miss": 0.09240994854182588, "gen_fpr": 0.05840665684593765, "threshold": 0.5}
{"event": "epoch", "epoch": 34, "train_loss": 0.2323704473448522, "train_ce_loss": 0.24318772348942178, "train_kd_loss": 0.13501502219023126, "val_loss": 0.7129818226921217, "val_f1": 0.4831932734742427, "val_miss": 0.06504065040544649, "val_fpr": 0.11968218847418315, "gen_f1": 0.8115606886914126, "gen_miss": 0.09691252144061555, "gen_fpr": 0.05987976271049095, "threshold": 0.5}
{"event": "epoch", "epoch": 35, "train_loss": 0.23476797172969038, "train_ce_loss": 0.245674968285091, "train_kd_loss": 0.13660506868001188, "val_loss": 0.7101963397047018, "val_f1": 0.4971503687007303, "val_miss": 0.0780487804865358, "val_fpr": 0.11053002112027503, "gen_f1": 0.811275959420001, "gen_miss": 0.12071183533421803, "gen_fpr": 0.05354938886011325, "threshold": 0.548}
{"event": "epoch", "epoch": 36, "train_loss": 0.23437013052629702, "train_ce_loss": 0.24520369905865555, "train_kd_loss": 0.13686807130773862, "val_loss": 0.690894056510284, "val_f1": 0.4956521699908696, "val_miss": 0.0731707317061273, "val_fpr": 0.11213919340228086, "gen_f1": 0.8209708688293412, "gen_miss": 0.09348198970820437, "gen_fpr": 0.05605765019705536, "threshold": 0.5}
{"event": "epoch", "epoch": 37, "train_loss": 0.23321003223007375, "train_ce_loss": 0.24376521069895138, "train_kd_loss": 0.13821348231850247, "val_loss": 0.6969745724597287, "val_f1": 0.4852070967402638, "val_miss": 0.06666666666558266, "val_fpr": 0.11837473599505342, "gen_f1": 0.8150277888058153, "gen_miss": 0.08833619210958761, "gen_fpr": 0.060437154118700306, "threshold": 0.5}
{"event": "epoch", "epoch": 38, "train_loss": 0.23368393756223446, "train_ce_loss": 0.2444436081431129, "train_kd_loss": 0.1368469505034613, "val_loss": 0.6875421734081116, "val_f1": 0.4982638849710234, "val_miss": 0.06666666666558266, "val_fpr": 0.11213919340228086, "gen_f1": 0.8112566665620491, "gen_miss": 0.10377358490543788, "gen_fpr": 0.058167774813847925, "threshold": 0.5}
{"event": "epoch", "epoch": 39, "train_loss": 0.23305320094029108, "train_ce_loss": 0.24382468407804317, "train_kd_loss": 0.13610990605119502, "val_loss": 0.6946842858885743, "val_f1": 0.49291541045002246, "val_miss": 0.06666666666558266, "val_fpr": 0.11465352509291495, "gen_f1": 0.8078063664330082, "gen_miss": 0.09476843910785857, "gen_fpr": 0.06238802404743306, "threshold": 0.5}
{"event": "epoch", "epoch": 40, "train_loss": 0.23551158943411077, "train_ce_loss": 0.24618399258364332, "train_kd_loss": 0.13946002089616025, "val_loss": 0.7095472449763162, "val_f1": 0.4967148449423869, "val_miss": 0.0780487804865358, "val_fpr": 0.11073116765552575, "gen_f1": 0.8222287397777771, "gen_miss": 0.09905660377337253, "gen_fpr": 0.05394752558026279, "threshold": 0.548}
{"event": "epoch", "epoch": 41, "train_loss": 0.2341434412833416, "train_ce_loss": 0.24470088382562002, "train_kd_loss": 0.1391265117083535, "val_loss": 0.7024016329726841, "val_f1": 0.4856175934391544, "val_miss": 0.06666666666558266, "val_fpr": 0.11817358945980269, "gen_f1": 0.8153062156073613, "gen_miss": 0.090909090908896, "gen_fpr": 0.05960106700638627, "threshold": 0.5}
{"event": "epoch", "epoch": 42, "train_loss": 0.23363876482754042, "train_ce_loss": 0.24431461479627725, "train_kd_loss": 0.13755616157343895, "val_loss": 0.7054855288779969, "val_f1": 0.48359965974405494, "val_miss": 0.06504065040544649, "val_fpr": 0.11948104193893243, "gen_f1": 0.8137574198490061, "gen_miss": 0.08940823327596611, "gen_fpr": 0.060795477166834894, "threshold": 0.5}
{"event": "final", "best_threshold": 0.5, "val_loss": 0.7054855288779969, "val_f1": 0.48359965974405494, "val_miss": 0.06504065040544649, "val_fpr": 0.11948104193893243, "gen_loss": 0.43457121732936976, "gen_f1": 0.8137574198490061, "gen_miss": 0.08940823327596611, "gen_fpr": 0.060795477166834894}
